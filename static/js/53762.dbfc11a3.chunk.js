"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[53762],{873638:(e,t,n)=>{n.r(t),n.d(t,{captureRef:()=>C,captureScreen:()=>j,default:()=>I,ensureModuleIsLoaded:()=>R,releaseCapture:()=>M});var r=n(887371),o=n(580753),a=n(545754),u=n(411987),i=n(695058),s=n(256666),l=n(202784),c=n(824931),d=n(341290),f=n(190769),p=n(320713),h=n(552322);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=d.default.RNViewShot,w=new Promise((function(){}));b||console.warn("react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.");var _=["png","jpg"].concat("android"===f.default.OS?["webm","raw"]:[]),g=["tmpfile","base64","data-uri"].concat("android"===f.default.OS?["zip-base64"]:[]),A={format:"png",quality:1,result:"tmpfile",snapshotContentContainer:!1,handleGLSurfaceViewOnAndroid:!1};function k(e){var t=y(y({},A),e),n=[];return"width"in t&&("number"!==typeof t.width||t.width<=0)&&(n.push("option width should be a positive number"),delete t.width),"height"in t&&("number"!==typeof t.height||t.height<=0)&&(n.push("option height should be a positive number"),delete t.height),("number"!==typeof t.quality||t.quality<0||t.quality>1)&&(n.push("option quality should be a number between 0.0 and 1.0"),t.quality=A.quality),"boolean"!==typeof t.snapshotContentContainer&&n.push("option snapshotContentContainer should be a boolean"),"boolean"!==typeof t.handleGLSurfaceViewOnAndroid&&n.push("option handleGLSurfaceViewOnAndroid should be a boolean"),-1===_.indexOf(t.format)&&(t.format=A.format,n.push("option format '"+t.format+"' is not in valid formats: "+_.join(" | "))),-1===g.indexOf(t.result)&&(t.result=A.result,n.push("option result '"+t.result+"' is not in valid formats: "+g.join(" | "))),{options:t,errors:n}}function R(){if(!b)throw new Error("react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.")}function C(e,t){if(R(),e&&"object"===typeof e&&"current"in e&&e.current&&!(e=e.current))return Promise.reject(new Error("ref.current is null"));if("number"!==typeof e){var n=(0,p.default)(e);if(!n)return Promise.reject(new Error("findNodeHandle failed to resolve view="+String(e)));e=n}var r=k(t),o=r.options;r.errors;return b.captureRef(e,o)}function M(e){"string"!==typeof e||b.releaseCapture(e)}function j(e){R();var t=k(e),n=t.options;t.errors;return b.captureScreen(n)}var I=function(e){(0,a.default)(n,e);var t=m(n);function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).firstLayoutPromise=new Promise((function(t){e.resolveFirstLayout=t})),e.capture=function(){return e.firstLayoutPromise.then((function(){var t=(0,o.default)(e).root;return t?C(t,e.props.options):w})).then((function(t){return e.onCapture(t),t}),(function(t){throw e.onCaptureFailure(t),t}))},e.onCapture=function(t){if(e.root){e.lastCapturedURI&&setTimeout(M,500,e.lastCapturedURI),e.lastCapturedURI=t;var n=e.props.onCapture;n&&n(t)}},e.onCaptureFailure=function(t){if(e.root){var n=e.props.onCaptureFailure;n&&n(t)}},e.syncCaptureLoop=function(t){if(cancelAnimationFrame(e._raf),"continuous"===t){var n="-";e._raf=requestAnimationFrame((function t(){e._raf=requestAnimationFrame(t),n!==e.lastCapturedURI&&(n=e.lastCapturedURI,e.capture())}))}},e.onRef=function(t){e.root=t},e.onLayout=function(t){var n=e.props.onLayout;e.resolveFirstLayout(t.nativeEvent.layout),n&&n(t)},e}var u=n.prototype;return u.componentDidMount=function(){"mount"===this.props.captureMode?this.capture():this.syncCaptureLoop(this.props.captureMode)},u.componentDidUpdate=function(e){void 0!==this.props.captureMode&&this.props.captureMode!==e.captureMode&&this.syncCaptureLoop(this.props.captureMode),"update"===this.props.captureMode&&this.capture()},u.componentWillUnmount=function(){this.syncCaptureLoop(null)},u.render=function(){var e=this.props.children;return(0,h.jsx)(c.default,{ref:this.onRef,collapsable:!1,onLayout:this.onLayout,style:this.props.style,children:e})},(0,r.default)(n)}(l.Component);I.captureRef=C,I.releaseCapture=M},853762:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var r=n(539144),o=n(877531),a=n(361301),u=n(10918),i=n(566147),s=n(737790),l=n(921311),c=n(202784),d=n(472719),f=n(783112),p=n(193530),h=n(38484),m=n(552322),v=n(470310),y=n(433996),b=n(866904),w=n(669083),_=n(196234),g=n(634795),A=n(873638),k=n(119804),R=n(292147),C=(n(213208),function(){var e=(0,g.default)((function*(){return null}));return function(){return e.apply(this,arguments)}}()),M=(0,n(324665).default)(),j=[{name:h.RevokeRoutes.ShareModal,component:function(){var e=(0,f.default)(),t=(0,c.useRef)(null),n=(0,c.useState)(0),r=(0,_.default)(n,2),i=r[0],s=r[1],l=(0,c.useMemo)((function(){return[e.formatMessage({id:"content__share_revoke_1"}),e.formatMessage({id:"content__share_revoke_2"}),e.formatMessage({id:"content__share_revoke_3"}),e.formatMessage({id:"content__share_revoke_4"})][i]}),[e,i]),d=(0,c.useCallback)((function(t){var n=t.close;(0,k.copyToClipboard)(l),w.default.show({title:e.formatMessage({id:"msg__copied"})}),null==n||n()}),[l,e]),p=(0,c.useCallback)(function(){var e=(0,g.default)((function*(e){var n,r=e.close;if(yield null==(n=t.current)||null==n.capture?void 0:n.capture()){var o=yield C(),a={type:"text/plain",title:"Share",message:l};if(!o)return;yield o.open(a).catch((function(e){R.default.common.error("share revoke error",e),d({close:r})})).finally((function(){null==r||r()}))}}));return function(t){return e.apply(this,arguments)}}(),[l,d]);return(0,m.jsx)(o.default,{header:e.formatMessage({id:"title__share"}),height:"560px",hidePrimaryAction:!0,onPrimaryActionPress:p,onSecondaryActionPress:d,primaryActionTranslationId:"action__share",secondaryActionTranslationId:"action__copy",children:(0,m.jsx)(a.default,{pt:"6",children:(0,m.jsxs)(A.default,{ref:t,children:[(0,m.jsx)(u.default.DisplayLarge,{textAlign:"center",mb:"1",children:e.formatMessage({id:"title__share_with_your_friends"})}),(0,m.jsx)(u.default.Body2,{textAlign:"center",mb:"6",children:e.formatMessage({id:"title__share_with_your_friends_desc"})}),(0,m.jsxs)(v.default,{alignItems:"center",borderWidth:"1",borderRadius:12,borderColor:"border-default",bg:"action-secondary-default",p:3,children:[(0,m.jsx)(b.default,{flex:"1",children:l}),(0,m.jsx)(y.default,{name:"ArrowPathMini",type:"plain",onPress:function(){return s(i>=3?0:i+1)}})]})]})})})}},{name:h.RevokeRoutes.ChangeAllowance,component:function(){var e=(0,f.default)(),t=(0,d.useRoute)().params,n=t.dapp,r=t.balance,v=t.token,y=t.networkId,b=t.allowance,w=(0,p.useUpdateAllowance)({networkId:y,spender:n.spender,contract:v.tokenIdOnNetwork}),_=(0,l.default)({mode:"onChange",defaultValues:{allowance:"unlimited"===b?"0":b,isUnlimited:"unlimited"===b}}),g=_.control,A=_.handleSubmit,k=_.watch,R=`${r} ${v.symbol}`,C=k("isUnlimited"),M=(0,c.useCallback)((function(e){w({amount:e,assetType:h.AssetType.tokens})}),[w]),j=(0,c.useCallback)((function(e){e.isUnlimited?M("unlimited"):M(String(e.allowance))}),[M]);return(0,m.jsx)(o.default,{header:e.formatMessage({id:"action__change_allowance"}),hideSecondaryAction:!0,onPrimaryActionPress:function(e){var t=e.close;null==t||t(),setTimeout((function(){A((function(e){return j(e)}))()}),600)},primaryActionTranslationId:"action__change",children:(0,m.jsxs)(a.default,{children:[(0,m.jsx)(s.default,{token:n,size:5,showInfo:!0}),(0,m.jsxs)(i.default,{mt:"3",children:[(0,m.jsx)(i.default.Item,{name:"isUnlimited",control:g,children:(0,m.jsx)(i.default.Switch,{isFullMode:!0,label:e.formatMessage({id:"form__unlimited_allowance"})})}),C?null:(0,m.jsx)(i.default.Item,{name:"allowance",label:e.formatMessage({id:"form__allowance"}),control:g,rules:{pattern:{value:/^\d+(\.\d+)?$/g,message:e.formatMessage({id:"form__enter_a_number_greater_than_or_equal_to_0"})},required:{value:!0,message:e.formatMessage({id:"form__field_is_required"})}},children:(0,m.jsx)(i.default.Input,{type:"string"})})]}),(0,m.jsx)(u.default.Body2,{mt:"2",children:`${e.formatMessage({id:"content__balance_str"},{0:R})}`})]})})}}];const I=function(){var e=(0,r.default)();return(0,m.jsx)(M.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:j.map((function(e){return(0,m.jsx)(M.Screen,{name:e.name,component:e.component},e.name)}))})}},193530:(e,t,n)=>{n.r(t),n.d(t,{useAccountCanTransaction:()=>_,useIsVerticalOrMiddleLayout:()=>A,useRevokeAddress:()=>y,useSpenderAppName:()=>w,useTokenAllowances:()=>b,useUpdateAllowance:()=>g});var r=n(384247),o=n(634795),a=n(196234),u=n(202784),i=n(472719),s=n(911929),l=n(626015),c=n(393587),d=n(506885),f=n(447325),p=n(945821),h=n(859071),m=n(481047),v=n(38484),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,u.useState)(""),n=(0,a.default)(t,2),r=n[0],i=n[1],s=(0,u.useState)(!0),l=(0,a.default)(s,2),c=l[0],d=l[1],f=(0,u.useCallback)((0,o.default)((function*(){d(!0);var t=yield p.default.serviceRevoke.getAddress(e);i(null!=t?t:""),setTimeout((function(){d(!1)}),1e3)})),[e]);return(0,u.useEffect)((function(){f()}),[e,f]),{updateAddress:f,address:r,loading:c}},b=function(e,t,n){var r,a,i,l,c=(0,s.useAsync)((0,o.default)((function*(){return p.default.serviceRevoke.fetchTokenAllowance(e,t,n,!1)})),[e,t,n]),d=c.result,h=c.loading,m=c.error,v=c.execute;return(0,u.useEffect)((function(){return f.appUIEventBus.on(f.AppUIEventBusNames.RevokeRefresh,v),function(){f.appUIEventBus.off(f.AppUIEventBusNames.RevokeRefresh,v)}}),[v]),m?{address:"",prices:{},allowances:[],loading:!1,isFromRpc:!1}:{address:null!=(r=null==d?void 0:d.address)?r:"",prices:null!=(a=null==d?void 0:d.prices)?a:{},allowances:null!=(i=null==d?void 0:d.allowance)?i:[],isFromRpc:null!=(l=null==d?void 0:d.isFromRpc)&&l,loading:h,error:m}},w=function(e,t){var n=(0,u.useState)(""),r=(0,a.default)(n,2),i=r[0],s=r[1],c=(0,u.useCallback)((0,o.default)((function*(){var n=yield p.default.serviceRevoke.getSpenderName(e,t);s(n)})),[t,e]);return(0,u.useEffect)((function(){c()}),[c]),i||(0,l.shortenAddress)(t)},_=function(e){var t=(0,h.useActiveWalletAccount)(),n=t.account,r=t.wallet;return(0,u.useMemo)((function(){return n&&n.id&&(null==n?void 0:n.address.toLowerCase())===e.toLowerCase()&&(null==r?void 0:r.type)!==d.WALLET_TYPE_WATCHING}),[n,e,null==r?void 0:r.type])},g=function(e){var t=e.networkId,n=e.spender,r=e.contract,a=(0,i.useNavigation)(),s=(0,h.useActiveWalletAccount)(),l=s.accountId,d=s.accountAddress,y=(0,u.useCallback)(function(){var e=(0,o.default)((function*(e){var o,u=e.amount,i=e.tokenId;o=e.assetType===v.AssetType.tokens?yield p.default.engine.buildEncodedTxFromApprove({amount:u,networkId:t,spender:n,accountId:l,token:r}):"undefined"!==typeof i?yield p.default.serviceRevoke.buildEncodedTxsFromApprove({from:d,to:null!=r?r:"",approve:c.ADDRESS_ZERO,tokenId:i}):yield p.default.serviceRevoke.buildEncodedTxsFromSetApprovalForAll({from:d,to:null!=r?r:"",approved:!1,spender:n}),a.navigate(m.RootRoutes.Modal,{screen:m.ModalRoutes.Send,params:{screen:m.SendModalRoutes.SendConfirm,params:{accountId:l,networkId:t,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:o,onSuccess:function(){f.appUIEventBus.emit(f.AppUIEventBusNames.RevokeRefresh)}}}})}));return function(t){return e.apply(this,arguments)}}(),[l,r,a,t,n,d]);return y},A=function(){var e=(0,r.default)().size;return(0,u.useMemo)((function(){return["SMALL","NORMAL"].includes(e)}),[e])}}}]);