"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[54779],{654779:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(539144),i=n(930822),a=n(755329),c=n(324665),o=n(552322),u=(0,c.default)(),s=[{name:a.PushNotificationRoutes.GuideToPushFirstTime,component:i.default}];const l=function(){var e=(0,r.default)();return(0,o.jsx)(u.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:s.map((function(e){return(0,o.jsx)(u.Screen,{name:e.name,component:e.component},e.name)}))})}},930822:(e,t,n)=>{n.r(t),n.d(t,{GuideToPushFirstTimeCheck:()=>E,default:()=>S});var r=n(877531),i=n(361301),a=n(18861),c=n(866904),o=n(795116),u=n(10918),s=n(256666),l=n(634795),f=n(202784),d=n(472719),p=n(783112),h=n(814817),y=n(292147),m=(n(213208),n(945821)),b=n(493877),v=n(481047),P=n(821919),_=n(830631),g=n(776553),O=n(352605),j=n(755329),A=n(552322);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(){var e=(0,b.default)(),t=m.default.serviceBootstrap,n=(0,f.useCallback)((function(){var n=!0,r=function(){var r=(0,l.default)((function*(){yield(0,g.wait)(1e3);var r=yield t.checkShouldShowNotificationGuide();n&&r&&e.navigate(v.RootRoutes.Modal,{screen:v.ModalRoutes.PushNotification,params:{screen:j.PushNotificationRoutes.GuideToPushFirstTime}})}));return function(){return r.apply(this,arguments)}}();return r(),function(){n=!1}}),[e,t]);return(0,d.useFocusEffect)(n),null}const S=function(){var e=(0,p.default)(),t=m.default.dispatch,n=m.default.serviceNotification,s=(0,O.useEvmWalletsAndAccounts)().wallets;(0,f.useEffect)((function(){t((0,_.setGuideToPushFistTime)(!0))}),[t]);var d=(0,f.useCallback)((0,l.default)((function*(){var e=s.map((function(e){return e.accounts.map((function(t){return D(D({},t),{},{passphrase:(0,h.isPassphraseWallet)(e)})}))})).flat().slice(0,50),t=yield n.filterContractAddresses(e.map((function(e){return e.address})));yield n.addAccountDynamicBatch({data:e.filter((function(e){return t.some((function(t){return t===e.address}))})).map((function(e){return{passphrase:e.passphrase,accountId:e.id,address:e.address,name:e.name}}))})})),[s,n]),b=(0,f.useCallback)(function(){var e=(0,l.default)((function*(e){var r=e.close;null==r||r(),t((0,P.setPushNotificationConfig)({pushEnable:!0,priceAlertEnable:!0,btcAndEthPriceAlertEnable:!0,favoriteTokensPriceAlertEnable:!0,accountActivityPushEnable:!0}));try{yield n.syncPushNotificationConfig(),yield d()}catch(i){y.default.notification.error("close notification addAccountDynamics error",i)}}));return function(t){return e.apply(this,arguments)}}(),[t,d,n]),v=(0,f.useMemo)((function(){return[{icon:"\ud83d\udea8",title:e.formatMessage({id:"form__price_volatility"}),desc:e.formatMessage({id:"form__price_volatility_desc"})},{icon:"\ud83d\udcc8",title:e.formatMessage({id:"form__price_alert"}),desc:e.formatMessage({id:"title__no_alert_desc"},{0:"tokens"})},{icon:"\ud83d\udc64",title:e.formatMessage({id:"form__account_activity"}),desc:e.formatMessage({id:"account_activity_desc"})}]}),[e]);return(0,A.jsx)(r.default,{height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:b,primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__allow",children:(0,A.jsxs)(i.default,{position:"relative",height:"full",children:[(0,A.jsx)(o.default,{position:"absolute",bottom:"-12px",width:"full",children:(0,A.jsx)(u.default.Body2,{children:e.formatMessage({id:"content__you_can_change_this_option_later_in_the_settings"})})}),(0,A.jsxs)(o.default,{children:[(0,A.jsx)(c.default,{fontSize:56,children:"\ud83d\udd14"}),(0,A.jsx)(u.default.DisplayLarge,{children:e.formatMessage({id:"title__notifications"})})]}),v.map((function(e,t){return(0,A.jsxs)(a.default,{px:"4",flexDirection:"row",mt:0===t?"64px":4,children:[(0,A.jsx)(u.default.DisplayLarge,{mr:"4",children:e.icon}),(0,A.jsxs)(a.default,{flex:1,children:[(0,A.jsx)(u.default.Body1Strong,{mb:"1",children:e.title}),(0,A.jsx)(u.default.Body2,{flex:1,numberOfLines:2,color:"text-subdued",children:e.desc})]})]},e.icon)}))]})})}},352605:(e,t,n)=>{n.r(t),n.d(t,{checkAccountCanSubscribe:()=>P,useEnabledAccountDynamicAccounts:()=>b,useEvmWalletsAndAccounts:()=>m,usePriceAlertlist:()=>v});var r=n(256666),i=n(634795),a=n(196234),c=n(202784),o=n(278489),u=n(393587),s=n(402814),l=n(613549),f=n(945821),d=n(747225);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){return[u.ADDRESS_ZERO,u.DUMMY_ADDRESS,u.DUMMY_ADDRESS_2,u.DUMMY_ADDRESS_3].includes(e)},m=function(){var e=f.default.engine,t=(0,c.useState)([]),n=(0,a.default)(t,2),r=n[0],u=n[1],s=(0,d.useRuntime)().wallets,p=(0,c.useCallback)((0,i.default)((function*(){var t=yield Promise.all(s.map(function(){var t=(0,i.default)((function*(t){var n,r=yield e.getAccounts(t.accounts);return h(h({},t),{},{accounts:null!=(n=null==r?void 0:r.filter((function(e){if(!e)return!1;var t=e||{},n=t.address,r=t.coinType;return!y(n)&&!!(0,o.isCoinTypeCompatibleWithImpl)(r,l.IMPL_EVM)})))?n:[]})}));return function(e){return t.apply(this,arguments)}}()));return u(t),t})),[e,s]);return(0,c.useEffect)((function(){p()}),[p]),{wallets:r,getWalletsAndAccounts:p}},b=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=(0,c.useState)(!1),n=(0,a.default)(t,2),r=n[0],o=n[1],u=f.default.serviceNotification,s=m(),l=s.wallets,d=s.getWalletsAndAccounts,p=(0,c.useState)([]),h=(0,a.default)(p,2),y=h[0],b=h[1],v=(0,c.useCallback)((0,i.default)((function*(){var e=yield u.queryAccountDynamic();b(e)})),[u]),P=(0,c.useCallback)((0,i.default)((function*(){o(!0);try{yield v(),yield d()}finally{o(!1)}})),[v,d]);return(0,c.useEffect)((function(){e&&P()}),[P,e]),{loading:r,wallets:l,enabledAccounts:y,refresh:P}},v=function(){var e=f.default.serviceNotification,t=(0,c.useState)(!1),n=(0,a.default)(t,2),r=n[0],o=n[1],u=(0,c.useState)([]),s=(0,a.default)(u,2),l=s[0],d=s[1],p=(0,c.useCallback)((0,i.default)((function*(){o(!0);try{var t=yield e.queryPriceAlertList();d(t||[])}catch(n){}o(!1)})),[e]);return(0,c.useEffect)((function(){p()}),[p]),{alerts:l,loading:r,fetchPriceAlerts:p}},P=function(){var e=(0,i.default)((function*(e,t){if(!e)return!1;var n=e||{},r=n.address,a=n.coinType;if(y(r))return!1;if(!(0,o.isCoinTypeCompatibleWithImpl)(a,l.IMPL_EVM))return!1;var c=yield(0,s.makeTimeoutPromise)({asyncFunc:function(){var e=(0,i.default)((function*(){return f.default.validator.isContractAddress(t,r)}));return function(){return e.apply(this,arguments)}}(),timeout:6e3,timeoutResult:!1});return!c}));return function(t,n){return e.apply(this,arguments)}}()},755329:(e,t,n)=>{var r;n.r(t),n.d(t,{PushNotificationRoutes:()=>r}),function(e){e.GuideToPushFirstTime="GuideToPushFirstTime"}(r||(r={}))}}]);