"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[60562],{618408:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Wt});var r=n(256666),o=n(539144),a=n(877531),i=n(361301),s=n(202784),d=n(472719),l=n(783112),u=n(942013),c=n(859071),f=n(840248),m=n(561220),p=n(10918),h=n(18861),g=n(225447),x=n(552322),y=function(e){var t=e.title,r=e.subtitle,o=e.source,a=void 0===o?n(296914):o,i=e.logo,s=e.num,d=e.onPress;return(0,x.jsxs)(m.default,{onPress:d,bg:"surface-default",px:"4",py:"3",flexDirection:"row",justifyContent:"space-between",borderRadius:12,children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsxs)(h.default,{mr:"3",position:"relative",children:[(0,x.jsx)(h.default,{w:"10",h:"10",borderRadius:"full",overflow:"hidden",children:(0,x.jsx)(g.default,{w:"10",h:"10",source:a})}),(0,x.jsx)(h.default,{w:"5",h:"5",background:"surface-subdued",flexDirection:"row",justifyContent:"center",alignItems:"center",borderRadius:"full",position:"absolute",bottom:"-1",right:"-1",children:(0,x.jsx)(g.default,{w:"4",h:"4",source:i})})]}),(0,x.jsxs)(h.default,{children:[(0,x.jsx)(p.default.Body1Strong,{children:t}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:r})]})]}),(0,x.jsx)(h.default,{flexDirection:"row",justifyContent:"center",alignItems:"center",children:(0,x.jsx)(p.default.Body1Strong,{color:"text-success",children:s})})]})},w=n(288471);const v=function(){var e=(0,l.default)(),t=(0,d.useRoute)(),r=t.params.networkId,o=(0,c.useAppSelector)((function(e){return e.staking.ethStakingApr})),m=(0,s.useMemo)((function(){if(!o)return[];var e=r===u.OnekeyNetwork.goerli?o.testnet:o.mainnet;return[{name:w.EthStakingSource.Kele,num:e.kele,value:`${(0,f.formatAmount)(e.kele,2)}%`,logo:n(746760)},{name:w.EthStakingSource.Lido,num:e.lido,value:`${(0,f.formatAmount)(e.lido,2)}%`,logo:n(345075)}].sort((function(e,t){return t.num-e.num}))}),[r,o]);return(0,x.jsx)(a.default,{header:e.formatMessage({id:"form__str_pools"},{0:"ETH"}),footer:null,children:(0,x.jsx)(i.default,{space:4,children:m.map((function(e){return(0,x.jsx)(y,{title:"ETH",subtitle:e.name,logo:e.logo,num:e.value,onPress:function(){null==t.params.onSelector||t.params.onSelector(e.name)}},e.name)}))})})};var k=n(606201),j=n(333665),_=n(529710),I=n(470310),b=n(866904),S=n(669083),T=n(634795),M=n(196234),O=n(259825),R=n(321668),A=n(795116),C=n(435581),P=n(206391),B=n.n(P),D=n(945821),N=n(585665),E=n(534159),L=n(920453),F=n(481047),H=n(179498),$=n(793525),q=n(530483),U=n(415008),z=(n(231052),n(13334)),V=(n(213208),function(e){e.text,e.onTextChange,(0,z.default)().height,(0,s.useMemo)((function(){return new RegExp("^(0|([1-9][0-9]*))?\\.?([0-9]{1,18})?$")}),[]);return null}),K=n(156462),Q=n(534756),W=n(133531);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t){return(0,s.useEffect)((function(){(0,U.isEvmNetworkId)(e)&&(0,Q.isAccountCompatibleWithNetwork)(t,e)&&D.default.serviceStaking.fetchKeleUnstakeOverview({networkId:e,accountId:t})}),[e,t]),(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.keleUnstakeOverviews)||null==(o=r[t])?void 0:o[e]}))}function Z(e,t){return(0,s.useEffect)((function(){(0,U.isEvmNetworkId)(e)&&(0,Q.isAccountCompatibleWithNetwork)(t,e)&&D.default.serviceStaking.fetchWithdrawOverview({networkId:e,accountId:t})}),[e,t]),(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.keleWithdrawOverviews)||null==(o=r[t])?void 0:o[e]}))}function Y(e,t){return(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.keleMinerOverviews)||null==(o=r[null!=t?t:""])?void 0:o[null!=e?e:""]}))}function ee(e){return(0,c.useAppSelector)((function(t){var n;return null==(n=t.staking.keleNetworkDashboardGlobal)?void 0:n[null!=e?e:""]}))}function te(e){var t=(0,l.default)(),n=Math.floor(e/1440);if(n>0)return`${n} ${t.formatMessage({id:"content__day"})}`;var r=Math.floor(e/60);return r>0?`${r} ${t.formatMessage({id:"content__hours"})}`:`${e} ${t.formatMessage({id:"content__minutes_lowercase"})}`}function ne(e,t){var n=function(e,t){return(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.keleIncomes)||null==(o=r[null!=t?t:""])?void 0:o[null!=e?e:""]}))}(e,t),r=function(e,t){return(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.keleOpHistory)||null==(o=r[null!=t?t:""])?void 0:o[null!=e?e:""]}))}(e,t);return(0,s.useMemo)((function(){var e=[];return n&&n.length&&(e=e.concat(n.map((function(e){return{type:"income",income:e,time:new Date(e.date).getTime()}})))),r&&r.length&&(e=e.concat(r.map((function(e){return{type:"op",op:e,time:(0,K.default)(e.history_time,"yyyy-MM-dd HH:mm:ss",new Date).getTime()}})))),e.sort((function(e,t){return t.time-e.time}))}),[n,r])}var re=function(e,t){var n=(0,c.useAppSelector)((function(e){return e.staking.lidoOverview})),r=(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.tokens.accountTokensBalance)||null==(o=r[null!=e?e:""])?void 0:o[null!=t?t:""]}));return(0,s.useMemo)((function(){var o,a,i;if(e&&t){var s=null==n||null==(o=n[t])?void 0:o[e],d=(0,W.getLidoContractAddress)(e),l=null==r||null==(a=r[d.toLowerCase()])?void 0:a.balance;return X(X({},s),{},{balance:null!=l?l:null==s?void 0:s.balance,nfts:null!=(i=null==s?void 0:s.nfts)?i:[]})}}),[e,t,n,r])},oe=function(e,t){var n=(0,c.useAppSelector)((function(e){return e.staking.lidoMaticOverview})),r=(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.tokens.accountTokensBalance)||null==(o=r[null!=e?e:""])?void 0:o[null!=t?t:""]}));return(0,s.useMemo)((function(){var o,a,i;if(e&&t){var s=null==n||null==(o=n[t])?void 0:o[e],d=(0,W.getStMaticContractAdderess)(e),l=null==r||null==(a=r[d.toLowerCase()])?void 0:a.balance;return X(X({},s),{},{balance:null!=l?l:null==s?void 0:s.balance,nfts:null!=(i=null==s?void 0:s.nfts)?i:[]})}}),[e,t,n,r])};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=function(e){return e.source===w.EthStakingSource.Lido?(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(345075)},"lido"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"Lido"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]}):(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(746760)},"kele"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"Kele"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]})},de=function(e){var t=e.mode,n=(0,l.default)();return t===w.KeleStakingMode.fast?(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(p.default.Body1Strong,{mr:"2",children:"\ud83d\ude85"}),(0,x.jsx)(p.default.Body2Strong,{children:n.formatMessage({id:"content__fast"})}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]}):(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(p.default.Body1Strong,{mr:"2",children:"\ud83d\ude95"}),(0,x.jsx)(p.default.Body2Strong,{children:n.formatMessage({id:"content__normal"})}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]})},le=function(e){return(0,x.jsx)(p.default.Body1,{color:"text-default",children:e})},ue=function(e){var t=e.closeOverlay,n=e.amount,r=e.remain,o=e.onConfirm,a=(0,l.default)(),i=(0,s.useCallback)((function(){t(),null==o||o()}),[t,o]);return(0,x.jsxs)(O.default,{closeOverlay:t,title:a.formatMessage({id:"title__staking_tips"}),children:[(0,x.jsx)(A.default,{children:(0,x.jsx)(p.default.Heading,{pt:"6",pb:"2",fontSize:60,fontWeight:600,lineHeight:70,children:"\ud83d\udcb8"})}),(0,x.jsx)(p.default.DisplayLarge,{textAlign:"center",children:a.formatMessage({id:"modal__insufficient_balance_in_system_address"})}),(0,x.jsx)(h.default,{my:"6",children:(0,x.jsx)(p.default.Body1,{color:"text-subdued",textAlign:"center",children:a.formatMessage({id:"modal__insufficient_balance_in_system_address_desc"},{0:`${n} ETH`,1:`${r} ETH`,a:le,b:le})})}),(0,x.jsx)(A.default,{h:"10",w:"full",children:(0,x.jsx)(R.default,{w:"full",size:"xl",type:"primary",onPress:i,children:a.formatMessage({id:"action__i_got_it"})})})]})};var ce=n(465760);const fe=function(){var e=(0,l.default)(),t=(0,d.useRoute)(),r=(0,d.useNavigation)(),o=(0,s.useCallback)((function(){r.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.StakedETHOnKele,params:{networkId:t.params.networkId,accountId:t.params.accountId}}})}),[r,t.params]);return(0,x.jsx)(a.default,{header:e.formatMessage({id:"modal__transaction_submitted"}),hideSecondaryAction:!0,primaryActionTranslationId:"action__close",onPrimaryActionPress:o,children:(0,x.jsxs)(i.default,{alignItems:"center",justifyContent:"center",flex:1,children:[(0,x.jsx)(h.default,{w:"200px",h:"200px",children:(0,x.jsx)(ce.default,{width:200,source:n(831903),autoPlay:!0,loop:!1})}),(0,x.jsx)(b.default,{typography:"DisplayMedium",children:e.formatMessage({id:"action__submit"})}),(0,x.jsx)(h.default,{h:8})]})})};var me=n(292147);const pe=n.p+"static/media/eth_staking.c3ba7ecb8a07735c50dd.png";function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const xe=n.p+"static/media/eth_unstake.3014a6f36d8b0df9ac9a.png";var ye=n(854787),we=n(79694);const ve=function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.mode,u=n.onSelector,c=ee(r),f=Number(null!=(e=null==c?void 0:c.validator_alive_predicted_hour)?e:"24"),m=f>24?t.formatMessage({id:"form__str_day"},{0:Math.ceil(f/24)}):t.formatMessage({id:"form__str_hours"},{0:f});return(0,s.useEffect)((function(){c||D.default.serviceStaking.getDashboardGlobal({networkId:r})}),[]),(0,x.jsx)(a.default,{header:t.formatMessage({id:"content__mode"}),footer:null,children:(0,x.jsxs)(i.default,{space:1,children:[(0,x.jsxs)(we.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:8,p:"2",bgColor:o===w.KeleStakingMode.normal?"surface-selected":void 0,onPress:function(){return null==u?void 0:u(w.KeleStakingMode.normal)},children:[(0,x.jsx)(h.default,{flexDirection:"row",alignItems:"center",children:(0,x.jsxs)(I.default,{space:1,children:[(0,x.jsx)(p.default.Body1Strong,{children:"\ud83d\ude95"}),(0,x.jsx)(p.default.Body1Strong,{children:t.formatMessage({id:"content__normal"})})]})}),(0,x.jsxs)(h.default,{alignItems:"flex-end",children:[(0,x.jsxs)(p.default.Body2Strong,{children:["~ ",m]}),(0,x.jsx)(p.default.Body2Strong,{children:t.formatMessage({id:"content__estimated_time"})})]})]}),(0,x.jsxs)(we.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:8,p:"2",bgColor:o===w.KeleStakingMode.fast?"surface-selected":void 0,onPress:function(){return null==u?void 0:u(w.KeleStakingMode.fast)},children:[(0,x.jsx)(h.default,{flexDirection:"row",alignItems:"center",children:(0,x.jsxs)(I.default,{space:1,children:[(0,x.jsx)(p.default.Body1Strong,{children:"\ud83d\ude85"}),(0,x.jsx)(p.default.Body1Strong,{children:t.formatMessage({id:"content__fast"})}),(0,x.jsx)(ye.default,{type:"info",title:t.formatMessage({id:"content__str_faster"},{0:"99.99%"}),size:"sm"})]})}),(0,x.jsxs)(h.default,{alignItems:"flex-end",children:[(0,x.jsxs)(p.default.Body2Strong,{children:["~ ",t.formatMessage({id:"form__str_minutes"},{0:"30"})]}),(0,x.jsx)(p.default.Body2Strong,{children:t.formatMessage({id:"content__estimated_time"})})]})]})]})})};var ke=n(568674),je=function(e){return(0,x.jsx)(p.default.Body1Strong,{color:"text-success",children:e})},_e=function(){var e=(0,l.default)();return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(i.default,{space:4,children:[(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ChartBarOutline"})}),(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__earn_up_to_str_per_year"},{a:je,0:"4.58%"})})]}),(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ArrowsRightLeftOutline"})}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__when_you_stake_str_you_receive_str_you_can_trade_this_liquid_asset_at_any_time"},{a:je,b:je,0:"ETH",1:"stETH"})})})]}),(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ClockOutline"})}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__you_start_earning_str"},{a:je})})})]}),(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"GiftOutline"})}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__rewards_are_automatically_credited_to_your_deposit_every_few_days"},{a:je})})})]})]}),(0,x.jsx)(ke.default,{renderCustomTrigger:function(t,n){return(0,x.jsx)(h.default,{py:"4",children:n?(0,x.jsx)(R.default,{size:"sm",type:"plain",rightIconName:"ChevronDownMini",iconColor:"icon-subdued",textProps:{color:"text-subdued"},onPress:t,children:e.formatMessage({id:"action__learn_more"})}):(0,x.jsx)(R.default,{size:"sm",type:"plain",rightIconName:"ChevronUpMini",iconColor:"icon-subdued",textProps:{color:"text-subdued"},onPress:t,children:e.formatMessage({id:"action__collapse"})})})},children:(0,x.jsxs)(i.default,{children:[(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__how_does_the_lido_protocol_work"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__how_does_the_lido_protocol_work_desc"})})}),(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__why_do_you_receive_steth"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__why_do_you_receive_steth_desc"})})}),(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__what_is_the_possible_risk_of_lido"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__what_is_the_possible_risk_of_lido_desc"})})})]})})]})};const Ie=function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=(0,s.useCallback)((function(){n.readonly?t.goBack():t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.ETHStake,params:{accountId:n.networkId,networkId:n.networkId,source:w.EthStakingSource.Lido}}})}),[t,n]);return(0,x.jsx)(a.default,{hideSecondaryAction:!0,primaryActionTranslationId:n.readonly?"action__i_got_it":"action__lets_go",onPrimaryActionPress:r,header:`${e.formatMessage({id:"form__staking"})} ETH`,scrollViewProps:{children:(0,x.jsx)(_e,{})}})};var be=n(232215),Se=n(401040),Te=n(375814);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){return"lido"===e.value?(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(345075)},"lido"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"Lido"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]}):(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(55337)},"onekey"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"OneKey Swap"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]})};const Ae=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,r=t.source,o=t.onSelector,u=t.amount,f=t.networkId,m=(0,s.useState)(!0),y=(0,M.default)(m,2),w=y[0],v=y[1],k=(0,c.useAppSelector)((function(e){return e.staking.stEthRate})),j=(0,s.useMemo)((function(){return null==k?void 0:k[f]}),[k,f]);return(0,s.useEffect)((function(){function e(){return e=(0,T.default)((function*(){var e=(0,c.getActiveWalletAccount)(),t=e.account,n=e.networkId;if(t&&n){var r,o=yield(0,Te.fetchStEthRate)({networkId:n,account:t,amount:u}),a=null==o||null==(r=o.data)?void 0:r.instantRate;a&&(D.default.dispatch((0,H.setStEthRate)({networkId:n,value:a})),v(!1))}})),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[u]),(0,x.jsx)(a.default,{footer:null,header:e.formatMessage({id:"form__route"}),children:(0,x.jsxs)(i.default,{space:"4",children:[(0,x.jsxs)(we.default,{flexDirection:"row",py:"3",px:"2",alignItems:"center",justifyContent:"space-between",bg:"lido"===r?"surface-selected":"background-default",borderRadius:12,onPress:function(){return null==o?void 0:o("lido")},children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"10",h:"10",mr:"3",source:n(345075)}),(0,x.jsxs)(h.default,{flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{children:"Lido"}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__str_day"},{0:"~ 1 - 3"}).toLowerCase()})]})]}),(0,x.jsxs)(h.default,{flexDirection:"column",alignItems:"flex-end",children:[(0,x.jsxs)(p.default.Body1Strong,{color:"text-success",children:[u||"0"," ETH"]}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__you_receive"})})]})]}),(0,x.jsxs)(we.default,{flexDirection:"row",py:"3",px:"2",alignItems:"center",justifyContent:"space-between",bg:"onekey"===r?"surface-selected":"background-default",borderRadius:12,onPress:function(){return null==o?void 0:o("onekey")},children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"10",h:"10",mr:"3",source:n(82631)}),(0,x.jsxs)(h.default,{flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{children:"OneKey Swap"}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"content__str_minutes_plural"},{0:"~ 1-5"})})]})]}),(0,x.jsxs)(h.default,{flexDirection:"column",alignItems:"flex-end",children:[u?(0,x.jsx)(h.default,{children:j&&!w?(0,x.jsxs)(p.default.Body1Strong,{color:"text-success",children:[(0,U.formatAmount)((0,U.multiply)(j,u),6)," ETH"]}):(0,x.jsx)(h.default,{w:"6",h:"4",overflow:"hidden",borderRadius:12,children:(0,x.jsx)(_.default,{})})}):(0,x.jsx)(p.default.Body1Strong,{color:"text-success",children:"0 ETH"}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__you_receive"})})]})]})]})})};var Ce=function(){var e=(0,l.default)();return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(A.default,{mt:"8",mb:"10",children:[(0,x.jsx)(g.default,{w:"24",h:"24",mb:"2",source:n(345075)}),(0,x.jsx)(p.default.DisplayLarge,{children:e.formatMessage({id:"title__lido_unstaking"})}),(0,x.jsx)(p.default.Body1,{color:"text-subdued",mt:"2",children:e.formatMessage({id:"title__lido_unstaking_desc"})})]}),(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",mb:"8",children:[(0,x.jsx)(A.default,{w:"8",h:"8",mr:"2",borderRadius:"full",bg:"decorative-surface-one",children:(0,x.jsx)(p.default.Body2Strong,{color:"decorative-icon-one",children:"1"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"form__request_withdrawal"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__request_withdrawal_desc"})})]})]}),(0,x.jsxs)(h.default,{flexDirection:"row",mb:"8",children:[(0,x.jsx)(A.default,{w:"8",h:"8",mr:"2",borderRadius:"full",bg:"decorative-surface-one",children:(0,x.jsx)(p.default.Body2Strong,{color:"decorative-icon-one",children:"2"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"form__receive_lido_nft"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__receive_lido_nft_desc"})})]})]}),(0,x.jsxs)(h.default,{flexDirection:"row",mb:"8",children:[(0,x.jsx)(A.default,{w:"8",h:"8",mr:"2",borderRadius:"full",bg:"decorative-surface-one",children:(0,x.jsx)(p.default.Body2Strong,{color:"decorative-icon-one",children:"3"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"form__claim"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__claim_desc"})})]})]})]})]})};const Pe=function(){var e=(0,l.default)(),t=(0,d.useRoute)(),n=(0,d.useNavigation)(),r=(0,s.useCallback)((function(){n.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoEthUnstake,params:{accountId:t.params.accountId,networkId:t.params.networkId}}})}),[n,t.params]);return(0,x.jsx)(a.default,{hideSecondaryAction:!0,primaryActionTranslationId:"action__i_got_it",onPrimaryActionPress:r,header:`${e.formatMessage({id:"action_unstake"})} ETH`,scrollViewProps:{children:(0,x.jsx)(Ce,{})}})};function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(){return(0,x.jsx)(h.default,{h:"1"})},Ee=function(e){var t=e.item,r=(0,d.useRoute)(),o=(0,d.useNavigation)(),a=r.params,i=a.networkId,l=a.accountId,u=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.serviceStaking.buildLidoMaticClaimWithdrawals({nftId:t.nftId,networkId:i,accountId:l}),n=yield D.default.engine.getAccount(l,i),r=De(De({},e),{},{from:n.address});o.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:F.SendModalRoutes.SendConfirm,params:{accountId:n.id,networkId:i,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:r,onSuccess:function(e,t){var r;D.default.dispatch((0,H.addTransaction)({accountId:n.id,networkId:i,transaction:{hash:e.txid,accountId:n.id,networkId:i,type:"lidoClaimMatic",nonce:null==t||null==(r=t.decodedTx)?void 0:r.nonce,addedTime:Date.now()}})),setTimeout((function(){o.goBack()}),100)}}}})})),[t,i,l,o]);return(0,x.jsx)(m.default,{onPress:u,children:function(e){var r=e.isHovered,o=e.isPressed;return(0,x.jsxs)(h.default,{flexDirection:"row",py:"1",px:"2",alignItems:"center",borderRadius:12,bgColor:o?"surface-pressed":r?"surface-hovered":void 0,justifyContent:"space-between",children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{borderRadius:"full",overflow:"hidden",mr:"2",w:"8",h:"8",source:n(31031)}),(0,x.jsxs)(p.default.Body1Strong,{children:[(0,U.formatAmount)(t.maticAmount,6)," MATIC"]})]}),(0,x.jsx)(C.default,{name:"ChevronRightMini",size:20})]})}})},Le=function(){var e=(0,l.default)();return(0,x.jsx)(h.default,{w:"full",px:"2",my:"1",children:(0,x.jsx)(p.default.Caption,{color:"text-subdued",children:e.formatMessage({id:"content__due_to_the_limitations_of_lido_you_must_claim_each_of_your_unstakes_separately"})})})};const Fe=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,n=t.networkId,r=t.accountId,o=oe(n,r),i=(0,s.useMemo)((function(){return null!=o&&o.nfts?o.nfts.filter((function(e){return e.claimable})):[]}),[null==o?void 0:o.nfts]),u=(0,s.useCallback)((function(e){var t=e.item;return(0,x.jsx)(Ee,{item:t})}),[]),c=(0,s.useCallback)((function(e){return String(e.nftId)}),[]);return(0,x.jsx)(a.default,{footer:null,header:e.formatMessage({id:"form__claim"}),flatListProps:{data:i,renderItem:u,keyExtractor:c,ItemSeparatorComponent:Ne,ListFooterComponent:Le}})};var He=function(e){return(0,x.jsx)(p.default.Body1Strong,{color:"text-success",children:e})},$e=function(){var e=(0,l.default)();return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(i.default,{space:4,children:[(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ChartBarOutline"})}),(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__earn_up_to_str_per_year"},{a:He,0:"4.3%"})})]}),(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ArrowsRightLeftOutline"})}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__when_you_stake_str_you_receive_str_you_can_trade_this_liquid_asset_at_any_time"},{a:He,b:He,0:"MATIC",1:"stMATIC"})})})]}),(0,x.jsxs)(h.default,{py:"3",px:"4",flexDirection:"row",borderRadius:12,bg:"surface-default",children:[(0,x.jsx)(h.default,{mr:"3",children:(0,x.jsx)(C.default,{name:"ClockOutline"})}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(p.Body1Strong,{children:e.formatMessage({id:"form__you_start_earning_str"},{a:He})})})]})]}),(0,x.jsx)(ke.default,{renderCustomTrigger:function(t,n){return(0,x.jsx)(h.default,{py:"4",children:n?(0,x.jsx)(R.default,{size:"sm",type:"plain",rightIconName:"ChevronDownMini",iconColor:"icon-subdued",textProps:{color:"text-subdued"},onPress:t,children:e.formatMessage({id:"action__learn_more"})}):(0,x.jsx)(R.default,{size:"sm",type:"plain",rightIconName:"ChevronUpMini",iconColor:"icon-subdued",textProps:{color:"text-subdued"},onPress:t,children:e.formatMessage({id:"action__collapse"})})})},children:(0,x.jsxs)(i.default,{children:[(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__how_does_the_lido_protocol_work"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__how_does_the_lido_protocol_work_desc"})})}),(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__why_do_you_receive_str"},{0:"stMATIC"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__why_do_you_receive_str_desc"},{0:"MATIC",1:"stMATIC"})})}),(0,x.jsx)(ke.default,{trigger:(0,x.jsx)(p.default.Body1,{color:"text-default",children:e.formatMessage({id:"form__what_is_the_possible_risk_of_lido"})}),children:(0,x.jsx)(p.default.Body1,{px:"2",color:"text-subdued",children:e.formatMessage({id:"form__what_is_the_possible_risk_of_lido_desc"})})})]})})]})};const qe=function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=(0,s.useCallback)((function(){n.readonly?t.goBack():t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.ETHStake,params:{accountId:n.networkId,networkId:n.networkId,source:w.EthStakingSource.Lido}}})}),[t,n]);return(0,x.jsx)(a.default,{hideSecondaryAction:!0,primaryActionTranslationId:n.readonly?"action__i_got_it":"action__lets_go",onPrimaryActionPress:r,header:`${e.formatMessage({id:"form__staking"})} MATIC`,scrollViewProps:{children:(0,x.jsx)($e,{})}})};var Ue=n(556805);function ze(e){return Ve.apply(this,arguments)}function Ve(){return Ve=(0,T.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.value,o=yield D.default.engine.findToken({networkId:t,tokenIdOnNetwork:(0,W.getStMaticContractAdderess)(t)}),a=yield D.default.engine.findToken({networkId:t,tokenIdOnNetwork:(0,W.getMaticContractAdderess)(t)});if(!a||!o)throw new Error("failed to quote swap price");var i=new(B())(r).toFixed(),s=yield D.default.engine.getNetwork(t),d=yield D.default.engine.getAccount(n,t),l={networkOut:s,networkIn:s,tokenOut:a,tokenIn:o,slippagePercentage:"1",typedValue:i,independentField:"INPUT",activeAccount:d,receivingAddress:d.address},u=yield Ue.SwapQuoter.client.fetchQuote(l),c=null==u?void 0:u.data;if(!c)throw new Error("failed to build unstake params");return{params:l,quote:c}})),Ve.apply(this,arguments)}function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We=function(e){return"lido"===e.value?(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(345075)},"lido"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"Lido"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]}):(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"5",h:"5",source:n(55337)},"onekey"),(0,x.jsx)(p.default.Body2Strong,{ml:"2",children:"OneKey Swap"}),(0,x.jsx)(C.default,{name:"ChevronRightMini"})]})},Ge=function(e){var t=e.value,n=e.networkId,r=e.accountId,o=(0,s.useState)(!1),a=(0,M.default)(o,2),i=a[0],d=a[1],l=(0,s.useState)(""),u=(0,M.default)(l,2),f=u[0],m=u[1],g=(0,s.useRef)({amount:"",num:0}),y=(0,c.useDebounce)(t,500);return(0,s.useEffect)((function(){function e(){return(e=(0,T.default)((function*(){if(y){g.current.amount=y,g.current.num+=1;try{d(!0);var e=y,t=yield ze({value:e,networkId:n,accountId:r});if(t&&t.quote&&e===g.current.amount){var o=(0,U.multiply)((0,U.div)(t.quote.buyAmount,t.quote.sellAmount),e);console.log("estimatedAmount",o),m(o)}}finally{g.current.num>0&&(g.current.num-=1),0===g.current.num&&d(!1)}}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[y,n,r]),i?(0,x.jsx)(h.default,{h:"4",width:"24",borderRadius:"2px",overflow:"hidden",children:(0,x.jsx)(_.default,{})}):(0,x.jsx)(h.default,{children:(0,x.jsxs)(p.default.Body2,{children:[(0,U.formatAmountExact)(f||"0",4)," Matic"]})})};const Xe=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,r=t.source,o=t.onSelector;return(0,x.jsx)(a.default,{footer:null,header:e.formatMessage({id:"form__route"}),children:(0,x.jsxs)(i.default,{space:"4",children:[(0,x.jsx)(we.default,{flexDirection:"row",py:"3",px:"2",alignItems:"center",justifyContent:"space-between",bg:"lido"===r?"surface-selected":"background-default",borderRadius:12,onPress:function(){return null==o?void 0:o("lido")},children:(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"10",h:"10",mr:"3",source:n(345075)}),(0,x.jsxs)(h.default,{flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{children:"Lido"}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__str_day"},{0:"~ 1 - 3"}).toLowerCase()})]})]})}),(0,x.jsx)(we.default,{flexDirection:"row",py:"3",px:"2",alignItems:"center",justifyContent:"space-between",bg:"onekey"===r?"surface-selected":"background-default",borderRadius:12,onPress:function(){return null==o?void 0:o("onekey")},children:(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(g.default,{w:"10",h:"10",mr:"3",source:n(82631)}),(0,x.jsxs)(h.default,{flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{children:"OneKey Swap"}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"content__str_minutes_plural"},{0:"~ 1-5"})})]})]})})]})})};var Je=n(447325),Ze=n(797749);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tt=n(510374),nt=n(433996),rt=n(259924),ot=n(785192),at=n(438341),it=n(46486),st=n(887371),dt=function(){function e(e){this.tx=e.tx,this.onFinish=e.onFinish}var t=e.prototype;return t.run=function(){var e=this;this.runTask();var t=this.getMs();t?this.timer=setTimeout((function(){e.run()}),t):this.stop()},t.stop=function(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)},t.getMs=function(){var e=this.tx.addedTime;return Date.now()-e<=36e5?2e4:3e5},t.queryTransactionProgress=function(){var e=(0,T.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield D.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})}}));return function(t){return e.apply(this,arguments)}}(),t.runTask=function(){var e=(0,T.default)((function*(){var e=this,t=this.tx,n=yield this.queryTransactionProgress(t);if(n){var r,o=n.status;if(o&&"pending"!==o)null==(r=this.onFinish)||r.call(this,{stop:function(){return e.stop()}})}}));return function(){return e.apply(this,arguments)}}(),(0,st.default)(e)}(),lt=function(e){var t=e.tx;return(0,s.useEffect)((function(){var e=new dt({tx:t,onFinish:function(e){(0,e.stop)(),D.default.dispatch((0,H.archiveTransaction)({accountId:t.accountId,networkId:t.networkId,txs:[t.hash]}));var n=t.type,r=(0,Te.getTransactionStakingType)(n);r===Te.StakingTypes.eth?D.default.serviceStaking.fetchLidoOverview({accountId:t.accountId,networkId:t.networkId}):r===Te.StakingTypes.matic&&D.default.serviceStaking.fetchLidoMaticOverview({accountId:t.accountId,networkId:t.networkId})}});return e.run(),function(){e.stop()}}),[]),null},ut=function(e){var t=e.tx;return(0,s.useEffect)((function(){var e=new dt({tx:t,onFinish:function(){var e=(0,T.default)((function*(e){var n=e.stop,r=yield D.default.serviceStaking.fetchKeleOpHistory({networkId:t.networkId,accountId:t.accountId}),o=null==r?void 0:r.find((function(e){return e.transaction_id.toLowerCase()===t.hash.toLowerCase()})),a=Date.now();(o||a-t.addedTime>864e5)&&(n(),D.default.dispatch((0,H.archiveKeleTransaction)({accountId:t.accountId,networkId:t.networkId,txs:[t.hash]})),D.default.serviceStaking.fetchMinerOverview({networkId:t.networkId,accountId:t.accountId}))}));return function(t){return e.apply(this,arguments)}}()});return e.run(),function(){e.stop()}}),[]),null};function ct(e){return Number(e)>0?`+${(0,f.formatAmount)(e,18)}`:(0,f.formatAmount)(e,18)}var ft=function(){var e,t,n=(0,l.default)(),r=(0,d.useNavigation)(),o=(0,d.useRoute)().params,a=o.networkId,i=o.accountId,u=Y(a,i),c=(0,s.useCallback)((function(){r.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.KeleEthUnstakeShouldUnderstand,params:{networkId:a,accountId:i}}})}),[r,a,i]),m=(0,s.useCallback)((function(){r.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.WithdrawAmount,params:{networkId:a,accountId:i}}})}),[r,a,i]);return(0,x.jsxs)(h.default,{borderRadius:12,flexDirection:"row",px:"3",py:"3",mt:"3",borderWidth:it.default.hairlineWidth,borderColor:"border-subdued",justifyContent:"space-between",children:[(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Caption,{color:"text-subdued",fontSize:"14px",children:n.formatMessage({id:"form__staking_uppercase"})}),(0,x.jsxs)(h.default,{mb:"2",mt:"1",flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(p.default.Body1,{children:(0,f.formatAmount)(null!=(e=null==u?void 0:u.amount.retail_staked)?e:"0",8)}),(0,x.jsx)(p.default.Body1,{children:" ETH"})]}),(0,x.jsx)(h.default,{flexDirection:"row",children:(0,x.jsx)(R.default,{size:"xs",onPress:c,children:n.formatMessage({id:"action_unstake"})})})]}),(0,x.jsx)(h.default,{w:"6",flexDirection:"row",justifyContent:"center",alignItems:"center",children:(0,x.jsx)(ot.default,{orientation:"vertical",color:"divider"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Caption,{color:"text-subdued",fontSize:"14px",children:n.formatMessage({id:"form__unstaked_uppercase"})}),(0,x.jsxs)(h.default,{mb:"2",mt:"1",flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(p.default.Body1,{children:(0,f.formatAmount)(null!=(t=null==u?void 0:u.amount.withdrawable)?t:"0",8)}),(0,x.jsx)(p.default.Body1,{children:" ETH"})]}),(0,x.jsx)(h.default,{flexDirection:"row",children:(0,x.jsx)(R.default,{size:"xs",onPress:m,children:n.formatMessage({id:"action__withdraw"})})})]})]})},mt=function(){var e,t,n=(0,l.default)(),r=(0,d.useRoute)().params,o=r.networkId,a=r.accountId,i=Y(o,a),u=Number(null!=(e=null==i?void 0:i.amount.retail_unstaking)?e:0),c=J(o,a),m=null!=(t=null==c?void 0:c.estimate_use_sec)?t:60,p=te(Math.floor(m/60));return(0,s.useEffect)((function(){if(u){var e=setInterval((function(){D.default.serviceStaking.fetchMinerOverview({networkId:o,accountId:a})}),3e4);return function(){return clearInterval(e)}}}),[o,a,u]),u?(0,x.jsx)(h.default,{mb:"2",children:(0,x.jsx)(rt.default,{dismiss:!1,alertType:"info",title:n.formatMessage({id:"msg__unstaking_in_progress_str"},{0:`${(0,f.formatAmount)(u,8)} ETH `}),description:n.formatMessage({id:"msg__unstaking_in_progress_str_desc"},{0:` ${p}`})})}):null},pt=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,n=t.networkId,r=t.accountId,o=function(e,t){return(0,c.useAppSelector)((function(n){var r,o;return null==(r=n.staking.kelePendingWithdraw)||null==(o=r[null!=t?t:""])?void 0:o[null!=e?e:""]}))}(n,r);return(0,s.useEffect)((function(){if(o){var e=setInterval((function(){D.default.serviceStaking.fetchPendingWithdrawAmount({networkId:n,accountId:r})}),12e4);return function(){return clearInterval(e)}}}),[n,r,o]),o?(0,x.jsx)(h.default,{mb:"2",children:(0,x.jsx)(rt.default,{dismiss:!1,alertType:"info",title:e.formatMessage({id:"msg__withdraw_in_progress_str"},{0:`${(0,f.formatAmount)(o,8)} ETH`})})}):null},ht=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,n=t.networkId,r=t.accountId,o=(0,c.useAppSelector)((function(e){return e.staking.keleTransactions})),a=(0,s.useMemo)((function(){var e,t;return o?(null!=(e=null==(t=o[r])?void 0:t[n])?e:[]).filter((function(e){return!e.archive&&"KeleStake"===e.type})):[]}),[o,n,r]),i=a.reduce((function(e,t){var n;return e+Number(null!=(n=t.amount)?n:0)}),0);return i>0?(0,x.jsxs)(h.default,{mb:"2",children:[(0,x.jsx)(rt.default,{alertType:"info",title:e.formatMessage({id:"msg__str_is_staking_in_progress"},{0:`${i} ETH`}),dismiss:!1}),a.map((function(e){return(0,x.jsx)(ut,{tx:e},e.hash)}))]}):null},gt=function(){var e,t,n,r,o,a,i,u=(0,l.default)(),m=(0,d.useRoute)().params,g=m.networkId,y=m.accountId,v=Y(g,y),k=(0,L.useNativeToken)(g),j=(0,c.useTokenBalance)({networkId:g,accountId:y,token:k}),_=(0,d.useNavigation)(),I=(0,L.useSimpleTokenPriceValue)({networkId:g}),b=ee(g),S=(0,s.useCallback)((function(){_.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.KeleEthUnstakeShouldUnderstand,params:{networkId:g,accountId:y,readonly:!0}}})}),[_,g,y]),T=(0,s.useCallback)((function(){_.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.ETHStake,params:{accountId:y,networkId:g,source:w.EthStakingSource.Kele}}})}),[_,y,g]),M=Number(null!=(e=null==v||null==(t=v.amount)?void 0:t.total_amount)?e:0)+Number(null!=(n=null==v?void 0:v.amount.withdrawable)?n:0),O=(0,f.formatAmount)(M,8),P=Number(O)!==M,B=Number(null!=(r=null==v||null==(o=v.amount)?void 0:o.staking_amount)?r:0);return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",w:"full",alignItems:"center",children:[(0,x.jsx)(p.default.Heading,{children:u.formatMessage({id:"content__total"})}),(0,x.jsx)(nt.default,{type:"plain",name:"QuestionMarkCircleOutline",size:"sm",onPress:S})]}),(0,x.jsxs)(h.default,{mt:"2",children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[P?(0,x.jsx)(p.default.Caption,{mr:"1",children:"~"}):null,(0,x.jsx)(p.default.DisplayXLarge,{children:`${O} ETH`})]}),(0,x.jsx)(E.FormatCurrency,{numbers:[null!=I?I:0,M],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:I?e:"-"})}})]}),(0,x.jsx)(h.default,{my:"4",children:(0,x.jsx)(R.default,{size:"xl",w:"full",type:"primary",onPress:T,children:u.formatMessage({id:"title__stake_str"},{0:"ETH"})})}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:u.formatMessage({id:"form__available_to_stake"})}),(0,x.jsxs)(p.default.Body2,{color:"text-subdued",children:[(0,f.formatAmount)(j,6)," ETH"]})]}),(0,x.jsx)(ft,{}),(0,x.jsxs)(h.default,{mt:"2",children:[B?(0,x.jsxs)(h.default,{p:"4",borderRadius:12,bg:"surface-default",flexDirection:"row",alignItems:"center",mb:"2",children:[(0,x.jsx)(A.default,{w:"10",h:"10",bg:"surface-neutral-default",borderRadius:"full",mr:"2",children:(0,x.jsx)(C.default,{name:"InboxArrowDownMini",size:16})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1,{children:u.formatMessage({id:"form__str_is_activating"},{0:`${B} ETH`})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:u.formatMessage({id:"form__str_is_activating_eth_desc"},{0:"ETH",1:null!=(a=null==b?void 0:b.validator_alive_predicted_hour)?a:"24",3:`${(null!=(i=null==b?void 0:b.retail_deposit_far)?i:32).toFixed(2)} ETH`})})]})]}):null,(0,x.jsx)(mt,{}),(0,x.jsx)(pt,{}),(0,x.jsx)(ht,{})]}),(0,x.jsx)(h.default,{my:"2",children:(0,x.jsx)(p.default.Heading,{children:u.formatMessage({id:"form__reward_history"})})})]})},xt=function(e){var t,n=e.item,r=(0,l.default)(),o=(0,d.useRoute)().params.networkId,a=(0,L.useSimpleTokenPriceValue)({networkId:o});return(0,x.jsxs)(h.default,{w:"full",children:[(0,x.jsxs)(h.default,{justifyContent:"space-between",flexDirection:"row",mb:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:r.formatMessage({id:"title__reward"})}),(0,x.jsxs)(p.default.Body1Strong,{children:[ct(n.reward)," ETH"]})]}),(0,x.jsxs)(h.default,{justifyContent:"space-between",flexDirection:"row",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:(0,at.default)(new Date(n.date),"LLL dd yyyy")}),(0,x.jsx)(E.FormatCurrency,{numbers:[null!=a?a:0,null!=(t=n.reward)?t:0],render:function(e){return(0,x.jsx)(p.default.Body2,{ml:3,color:"text-subdued",children:a?e:"-"})}})]})]})},yt=function(e){var t,n=e.item,r=(0,l.default)(),o=(0,d.useRoute)().params.networkId,a=(0,L.useSimpleTokenPriceValue)({networkId:o}),i=Number(n.op_type),s=r.formatMessage({id:"action__stake"}),u="";return 1===i?(s=r.formatMessage({id:"form__staking"}),n.remain_time&&(u=r.formatMessage({id:"transaction__pending"}))):2===i?(s=r.formatMessage({id:"form__unstaking"}),n.remain_time&&(u=r.formatMessage({id:"transaction__pending"}))):3!==i&&4!==i||(s=r.formatMessage({id:"action__withdraw"})),(0,x.jsxs)(h.default,{w:"full",children:[(0,x.jsxs)(h.default,{justifyContent:"space-between",flexDirection:"row",mb:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:s}),(0,x.jsxs)(p.default.Body1Strong,{children:[ct(n.amount)," ETH"]})]}),(0,x.jsxs)(h.default,{justifyContent:"space-between",flexDirection:"row",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:(0,at.default)((0,K.default)(n.history_time,"yyyy-MM-dd HH:mm:ss",new Date),"LLL dd yyyy")}),u?(0,x.jsx)(h.default,{children:(0,x.jsx)(p.default.Body2,{color:"text-highlight",children:u})}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=a?a:0,null!=(t=n.amount)?t:0],render:function(e){return(0,x.jsx)(p.default.Body2,{ml:3,color:"text-subdued",children:a?e:"-"})}})]})]})},wt=function(){var e=(0,l.default)();return(0,x.jsx)(h.default,{py:"10",children:(0,x.jsx)(tt.default,{emoji:"\ud83d\udd50",title:e.formatMessage({id:"transaction__history_empty_title"}),subTitle:e.formatMessage({id:"reward__history_empty_desc"})})})};var vt=n(968079),kt=n(516535);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var It=function(e){var t=new(B())(e);return t.lt("0.00000001")?(0,kt.formatDecimalZero)(t.toNumber()):(0,f.formatAmount)(e,18)},bt=function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,a=re(r,o),i=(0,s.useCallback)((0,T.default)((function*(){var e;if(a&&o){var n=(null!=(e=a.nfts)?e:[]).filter((function(e){return!e.isClaimed&&e.isFinalized})).map((function(e){return e.requestId})),i=yield D.default.serviceStaking.buildLidoClaimWithdrawals({requestIds:n,networkId:r}),s=yield D.default.engine.getAccount(o,r),d=_t(_t({},i),{},{from:s.address});t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:F.SendModalRoutes.SendConfirm,params:{accountId:s.id,networkId:r,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:d,onSuccess:function(e,t){var n;D.default.dispatch((0,H.addTransaction)({accountId:s.id,networkId:r,transaction:{hash:e.txid,accountId:s.id,networkId:r,type:"lidoClaim",nonce:null==t||null==(n=t.decodedTx)?void 0:n.nonce,addedTime:Date.now()}}))}}}})}})),[t,a,r,o]);return a&&a.nfts&&a.nfts.length&&a.withdrawal&&Number(a.withdrawal)>0?(0,x.jsx)(rt.default,{alertType:"info",title:`${(0,U.formatAmountExact)(a.withdrawal,4)} ETH ${e.formatMessage({id:"form__available_for_claim"})}`,dismiss:!1,onAction:i,action:e.formatMessage({id:"form__claim"})}):null},St=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,n=t.networkId,r=t.accountId,o=(0,c.useAppSelector)((function(e){return e.staking.transactions})),a=(0,s.useMemo)((function(){var e,t;return o?(null!=(e=null==(t=o[r])?void 0:t[n])?e:[]).filter((function(e){return!e.archive&&(0,Te.getTransactionStakingType)(e.type)===Te.StakingTypes.eth})):[]}),[o,n,r]);return a.length>0?(0,x.jsxs)(h.default,{children:[(0,x.jsx)(rt.default,{alertType:"info",title:e.formatMessage({id:"msg__there_are_str_requests_waiting_for_confirmation_currently"},{0:a.length}),dismiss:!1}),a.map((function(e){return(0,x.jsx)(lt,{tx:e},e.hash)}))]}):null},Tt=function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,a=re(r,o),u=(0,L.useNativeToken)(r),m=(0,c.useTokenBalance)({networkId:r,accountId:o,token:u}),g=(0,d.useNavigation)(),y=(0,L.useSimpleTokenPriceValue)({networkId:r}),v=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoEthUnstakeShouldUnderstand,params:{networkId:r,accountId:o}}})}),[g,r,o]),k=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoEthStakeShouldUnderstand,params:{readonly:!0,networkId:r,accountId:o}}})}),[g,r,o]),j=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.ETHStake,params:{networkId:r,accountId:o,source:w.EthStakingSource.Lido}}})}),[g,r,o]),_=null!=(e=null==a?void 0:a.balance)?e:"0.00",I=(0,U.gt)(_,"0")?(0,f.formatAmount)(_,8):"0.00";return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",w:"full",alignItems:"center",children:[(0,x.jsx)(p.default.Heading,{children:t.formatMessage({id:"content__total"})}),(0,x.jsx)(nt.default,{type:"plain",name:"QuestionMarkCircleOutline",size:"sm",onPress:k})]}),(0,x.jsxs)(h.default,{mt:"2",children:[(0,x.jsx)(h.default,{flexDirection:"row",alignItems:"center",children:(0,x.jsx)(p.default.DisplayXLarge,{children:`${I} stETH`})}),(0,x.jsx)(E.FormatCurrency,{numbers:[null!=y?y:0,_],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:y?e:"-"})}})]}),(0,x.jsxs)(h.default,{my:"4",flexDirection:"row",children:[(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(R.default,{size:"xl",w:"full",type:"primary",onPress:j,children:t.formatMessage({id:"action__stake"})})}),(0,x.jsx)(h.default,{w:"4"}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(R.default,{size:"xl",w:"full",onPress:v,children:t.formatMessage({id:"action__unstake"})})})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__available_to_stake"})}),(0,x.jsxs)(p.default.Body2,{color:"text-default",children:[(0,f.formatAmount)(m,6)," ETH"]})]}),(0,x.jsxs)(i.default,{space:"4",mt:"4",children:[(0,x.jsx)(bt,{}),(0,x.jsx)(St,{})]}),(0,x.jsx)(h.default,{my:"2",children:(0,x.jsx)(p.default.Heading,{children:t.formatMessage({id:"form__active_request"})})})]})},Mt=function(){var e=(0,l.default)();return(0,x.jsx)(h.default,{py:"10",children:(0,x.jsx)(tt.default,{emoji:"\ud83d\udd50",title:e.formatMessage({id:"empty__no_data"})})})};function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var At=function(e){var t=new(B())(e);return t.lt("0.00000001")?(0,kt.formatDecimalZero)(t.toNumber()):(0,f.formatAmount)(e,6)},Ct=function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,a=oe(r,o),i=(0,s.useCallback)((0,T.default)((function*(){var e;if(a&&o){var n=yield D.default.engine.getAccount(o,r),i=(null!=(e=a.nfts)?e:[]).filter((function(e){return e.claimable})).map((function(e){return e.nftId}));if(i.length>1)t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoMaticClaim,params:{accountId:n.id,networkId:r}}});else{var s=Rt(Rt({},yield D.default.serviceStaking.buildLidoMaticClaimWithdrawals({nftId:i[0],networkId:r,accountId:o})),{},{from:n.address});t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:F.SendModalRoutes.SendConfirm,params:{accountId:n.id,networkId:r,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:s,onSuccess:function(e,t){var o;D.default.dispatch((0,H.addTransaction)({accountId:n.id,networkId:r,transaction:{hash:e.txid,accountId:n.id,networkId:r,type:"lidoClaimMatic",nonce:null==t||null==(o=t.decodedTx)?void 0:o.nonce,addedTime:Date.now()}}))}}}})}}})),[t,a,r,o]),u=(0,s.useMemo)((function(){var e="0",t=null==a?void 0:a.nfts;if(!t)return{withdrawal:e};var n=t.filter((function(e){return e.claimable}));return n.length>0&&(e=n.reduce((function(e,t){return(0,U.plus)(e,t.maticAmount)}),"0")),{withdrawal:e,items:n}}),[a]);return(0,U.gt)(u.withdrawal,"0")?(0,x.jsx)(rt.default,{alertType:"info",title:`${(0,U.formatAmountExact)(u.withdrawal,4)} MATIC ${e.formatMessage({id:"form__available_for_claim"})}`,dismiss:!1,onAction:i,action:e.formatMessage({id:"form__claim"})}):null},Pt=function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,n=t.networkId,r=t.accountId,o=(0,c.useAppSelector)((function(e){return e.staking.transactions})),a=(0,s.useMemo)((function(){var e,t;return o?(null!=(e=null==(t=o[r])?void 0:t[n])?e:[]).filter((function(e){return!e.archive&&(0,Te.getTransactionStakingType)(e.type)===Te.StakingTypes.matic})):[]}),[o,n,r]);return a.length>0?(0,x.jsxs)(h.default,{children:[(0,x.jsx)(rt.default,{alertType:"info",title:e.formatMessage({id:"msg__there_are_str_requests_waiting_for_confirmation_currently"},{0:a.length}),dismiss:!1}),a.map((function(e){return(0,x.jsx)(lt,{tx:e},e.hash)}))]}):null},Bt=function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,a=oe(r,o),u=(0,L.useSingleToken)(r,(0,W.getMaticContractAdderess)(r)).token,m=(0,c.useTokenBalance)({networkId:r,accountId:o,token:u}),g=(0,d.useNavigation)(),y=(0,L.useSimpleTokenPriceValue)({networkId:r,contractAdress:(0,W.getMaticContractAdderess)(r)}),v=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoMaticUnstake,params:{networkId:r,accountId:o}}})}),[g,r,o]),k=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoMaticStakeShouldUnderstand,params:{readonly:!0,networkId:r,accountId:o}}})}),[g,r,o]),j=(0,s.useCallback)((function(){g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.MaticStake,params:{networkId:r,accountId:o}}})}),[g,r,o]),_=null!=(e=null==a?void 0:a.balance)?e:"0.00",I=(0,U.gt)(_,"0")?(0,f.formatAmount)(_,8):"0.00";return(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",w:"full",alignItems:"center",children:[(0,x.jsx)(p.default.Heading,{children:t.formatMessage({id:"content__total"})}),(0,x.jsx)(nt.default,{type:"plain",name:"QuestionMarkCircleOutline",size:"sm",onPress:k})]}),(0,x.jsxs)(h.default,{mt:"2",children:[(0,x.jsx)(h.default,{flexDirection:"row",alignItems:"center",children:(0,x.jsx)(p.default.DisplayXLarge,{children:`${I} stMATIC`})}),(0,x.jsx)(E.FormatCurrency,{numbers:[null!=y?y:0,_],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:y?e:"-"})}})]}),(0,x.jsxs)(h.default,{my:"4",flexDirection:"row",children:[(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(R.default,{size:"xl",w:"full",type:"primary",onPress:j,children:t.formatMessage({id:"action__stake"})})}),(0,x.jsx)(h.default,{w:"4"}),(0,x.jsx)(h.default,{flex:"1",children:(0,x.jsx)(R.default,{size:"xl",w:"full",onPress:v,children:t.formatMessage({id:"action__unstake"})})})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__available_to_stake"})}),(0,x.jsxs)(p.default.Body2,{color:"text-default",children:[(0,f.formatAmount)(m,6)," MATIC"]})]}),(0,x.jsxs)(i.default,{space:"4",mt:"4",children:[(0,x.jsx)(Ct,{}),(0,x.jsx)(Pt,{})]}),(0,x.jsx)(h.default,{my:"2",children:(0,x.jsx)(p.default.Heading,{children:t.formatMessage({id:"form__active_request"})})})]})},Dt=function(){var e=(0,l.default)();return(0,x.jsx)(h.default,{py:"10",children:(0,x.jsx)(tt.default,{emoji:"\ud83d\udd50",title:e.formatMessage({id:"empty__no_data"})})})};var Nt=n(719392),Et=n(746760),Lt=n(747225),Ft=n(776553);function Ht(e){var t=e.title,n=e.titleAction,r=e.text,o=e.onChangeText,a=e.loading,i=e.desc;return(0,x.jsxs)(h.default,{height:"140px",children:[!!t&&(0,x.jsxs)(I.default,{space:2,alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(h.default,{opacity:0,children:n}),(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:t}),n]}),(0,x.jsx)(A.default,{flex:1,maxH:"64px",mt:2,mb:3,children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:r,onChangeText:o,placeholder:"0"})}),a?(0,x.jsx)(Nt.default,{size:"sm"}):!!i&&(0,x.jsx)(b.default,{typography:"Body1Strong",textAlign:"center",isTruncated:!0,children:i})]})}function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ut=n(626015);var zt=n(679978);function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Kt=(0,n(324665).default)(),Qt=[{name:w.StakingRoutes.StakingAmount,component:function(){var e=(0,l.default)(),t=((0,z.default)().height,(0,o.default)()),n=(0,s.useState)(!1),r=(0,M.default)(n,2),i=r[0],u=r[1],f=(0,d.useNavigation)(),m=(0,d.useRoute)().params,y=m.networkId,v=m.tokenIdOnNetwork,k=m.accountId,j=(0,s.useState)(""),_=(0,M.default)(j,2),I=_[0],O=_[1],A=(0,c.useNetworkSimple)(y),C=(0,L.useSingleToken)(y,null!=v?v:"").token,P=(0,c.useTokenBalanceWithoutFrozen)({networkId:y,accountId:k,token:C,fallback:"0"}),D=(0,s.useCallback)((function(){if(!C||!I)return"error";var t,n,r=new(B())(I),o=new(B())(P);return r.isNaN()||o.isNaN()?e.formatMessage({id:"form__amount_invalid"},{0:null!=(t=null==C?void 0:C.symbol)?t:""}):o.isLessThan(r)?e.formatMessage({id:"form__amount_invalid"},{0:null!=(n=null==C?void 0:C.symbol)?n:""}):void 0}),[I,e,P,C])(),N=(0,s.useMemo)((function(){return new(B())("0.01")}),[]),H=(0,s.useMemo)((function(){if(!N.isNaN()&&N.gt("0")){var e=new(B())(I);if(e.isNaN())return[!1,!1];if(e.lt(N))return[!1,e.gt("0")]}return[!0,!1]}),[N,I]),$=(0,M.default)(H,2),q=$[0],U=$[1],V=(0,s.useMemo)((function(){return U?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:e.formatMessage({id:"form__str_minimum_stake_amount"},{0:N.toFixed(),1:null==C?void 0:C.symbol})}):void 0}),[e,N,U,null==C?void 0:C.symbol]),K=function(e){var t,n,r,o=e.tokenInfo,a=e.desc,i=e.network,d=e.amount,l=e.setAmount,u=e.tokenBalance,c=null!=(t=null!=o&&o.tokenIdOnNetwork?null==i?void 0:i.tokenDisplayDecimals:null==i?void 0:i.nativeDisplayDecimals)?t:2,f=null!=(n=null==o?void 0:o.decimals)?n:18,m=(0,s.useMemo)((function(){return new RegExp(`^(0|([1-9][0-9]*))?\\.?([0-9]{1,${f}})?$`)}),[f]),p=(0,Lt.useSettings)().selectedFiatMoneySymbol,h=(void 0===p?"usd":p).toUpperCase().trim(),g=(0,s.useState)(!1),y=(0,M.default)(g,2),w=y[0],v=y[1],k=w?2:f,j=(0,s.useMemo)((function(){return new RegExp(`^(0|([1-9][0-9]*))?\\.?([0-9]{1,${k}})?$`)}),[k]),_=(0,L.useSimpleTokenPriceValue)({networkId:null==o?void 0:o.networkId,contractAdress:null==o?void 0:o.tokenIdOnNetwork}),I=(0,s.useState)(d),S=(0,M.default)(I,2),T=S[0],O=S[1],R=(0,s.useMemo)((function(){return new(B())(null!=_?_:0)}),[_]),A=!R.isNaN()&&R.gt(0),C=(0,s.useCallback)((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return e?t?R.times(t||"0").toFixed(2,n):"":t}),[R]),P=(0,s.useCallback)((function(e){var t=C(w,e,B().ROUND_FLOOR);O(t)}),[C,w]),D=(0,s.useCallback)((function(e){if(e.length<d.length)l(e);else if(m.test(e))l(e);else{var t=new(B())(e);if(!t.isNaN()){var n=t.toFixed(f,B().ROUND_FLOOR);l(n)}}}),[d.length,f,l,m]),N=(0,x.jsx)(nt.default,{name:"ArrowsUpDownOutline",size:"lg",type:"plain",circle:!0,onPress:function(){var e;T&&T===u&&!w&&(e=B().ROUND_FLOOR);var t=!w;v(t),O(C(t,d,e))}}),F=(0,s.useMemo)((function(){return a||(w?(0,x.jsxs)(b.default,{children:[(null==(e=(0,E.formatBalanceDisplay)(d||"0","",{fixed:c}))?void 0:e.amount)||d||"0"," ",null==o?void 0:o.symbol]}):(0,x.jsx)(E.FormatCurrencyToken,{token:o,value:d,render:function(e){return(0,x.jsx)(b.default,{children:e})}}));var e}),[d,c,a,w,o]);return(0,s.useEffect)((function(){return D(w?T?new(B())(T).div(R).toFixed():"":T)}),[w,D,T,R]),{validAmountRegex:m,title:null!=(r=w?h:null==o?void 0:o.symbol)?r:"--",titleAction:A?N:void 0,isFiatMode:w,descView:F,text:T,onTextChange:function(e){if(e.length<T.length)O(e);else if(j.test(e))O(e);else{var t=new(B())(e);if(!t.isNaN()){var n=t.toFixed(k,B().ROUND_FLOOR);O(n)}}},setTextByAmount:P}}({tokenInfo:C,desc:V,network:A,amount:I,setAmount:O,tokenBalance:P}),Q=K.title,W=K.titleAction,G=K.descView,X=K.text,J=K.onTextChange,Z=(K.validAmountRegex,K.setTextByAmount),Y=K.isFiatMode;return(0,x.jsx)(a.default,{header:e.formatMessage({id:"title__stake_str"},{0:null==C?void 0:C.symbol.toUpperCase()}),primaryActionTranslationId:"action__next",hideSecondaryAction:!0,primaryActionProps:{isDisabled:!!D||!q,isLoading:i},onPrimaryActionPress:(0,T.default)((function*(){if(A&&C){var t=Y?I:X;try{u(!0),yield(0,Ft.wait)(100),f.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.KeleEthStakeShouldUnderstand,params:{networkId:C.networkId,accountId:k,tokenIdOnNetwork:C.tokenIdOnNetwork,amount:t}}})}catch(o){console.error(o);var n,r=o.key;if("form__amount_invalid"===(void 0===r?"":r))S.default.show({title:e.formatMessage({id:"form__amount_invalid"},{0:null!=(n=null==C?void 0:C.symbol)?n:""})})}finally{u(!1)}}})),children:(0,x.jsxs)(h.default,{flex:1,flexDirection:"column",style:{userSelect:"none"},children:[(0,x.jsx)(h.default,{py:t?4:void 0,my:6,flex:1,justifyContent:"center",children:(0,x.jsx)(Ht,{title:Q,titleAction:W,desc:G,text:X,onChangeText:J})}),(0,x.jsxs)(h.default,{mt:"auto",children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsxs)(h.default,{flex:1,children:[(0,x.jsx)(p.default.Caption,{color:"text-subdued",children:e.formatMessage({id:"content__available_balance"})}),(0,x.jsx)(h.default,{children:(0,x.jsx)(E.FormatBalanceToken,{token:C,render:function(e){return(0,x.jsx)(p.default.Body1Strong,{color:D&&I?"text-critical":"text-default",children:e})}})})]}),(0,x.jsx)(R.default,{isDisabled:Number(P)-.01<=0,onPress:function(){var e=Math.max(Number(P)-.01,0);Z(String(e))},children:e.formatMessage({id:"action__max"})})]}),(0,x.jsxs)(h.default,{borderRadius:12,flexDirection:"row",px:"16px",py:"12px",mt:"3",mb:"3",borderWidth:it.default.hairlineWidth,borderColor:"border-subdued",children:[(0,x.jsx)(g.default,{w:"10",h:"10",source:Et,mr:"4"}),(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",children:[(0,x.jsx)(p.default.Body1,{children:"Kele Pool "}),(0,x.jsx)(p.default.Body1,{color:"text-success",children:"4.12% APY"})]}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"content__third_party_validator"})})]})]}),!1]})]})})}},{name:w.StakingRoutes.KeleEthStakeShouldUnderstand,component:function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=n.accountId,o=n.networkId,i=n.amount,u=(0,c.useNativeToken)(o),f=(0,s.useCallback)((function(){var e=t.getParent();null!=e&&e.canGoBack()&&e.goBack()}),[t]),m=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.engine.getAccount(r,o);if(e&&u){try{yield D.default.serviceStaking.registerOnKele({payeeAddr:e.address,networkId:o})}catch(s){me.default.common.error("registerOnKele failed")}var n,a=new(B())(i).shiftedBy(u.decimals).toFixed(0);try{n=ge(ge({},yield D.default.serviceStaking.buildTxForStakingETHtoKele({value:a,networkId:o})),{},{from:e.address})}catch(d){return void S.default.show({title:d.message},{type:"error"})}f(),t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SendConfirm,params:{networkId:o,accountId:r,payloadInfo:{type:"InternalStake",stakeInfo:{tokenInfo:u,amount:i,accountAddress:e.address}},feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:n}}})}})),[o,i,r,t,u,f]);return(0,x.jsx)(a.default,{hideSecondaryAction:!0,primaryActionTranslationId:"action__confirm",primaryActionProps:{onPromise:m},scrollViewProps:{children:(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(A.default,{p:"6",children:[(0,x.jsx)(g.default,{w:"24",h:"24",source:pe}),(0,x.jsx)(p.default.DisplayLarge,{my:"6",children:e.formatMessage({id:"title__eth_2_0_staking"})})]}),(0,x.jsx)(h.default,{children:(0,x.jsx)(h.default,{flexDirection:"row",mt:"5",children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"content__in_the_rare_event_staked_eth_will_be_lost"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",textBreakStrategy:"highQuality",children:e.formatMessage({id:"content__in_the_rare_event_staked_eth_will_be_lost_desc"})})]})})})]})}})}},{name:w.StakingRoutes.StakedETHOnKele,component:function(){var e=(0,d.useRoute)().params,t=e.networkId,n=e.accountId,r=ne(t,n);(0,s.useEffect)((function(){D.default.serviceStaking.fetchPendingWithdrawAmount({networkId:t,accountId:n}),D.default.serviceStaking.fetchMinerOverview({accountId:n,networkId:t}),D.default.serviceStaking.fetchKeleIncomeHistory({accountId:n,networkId:t}),D.default.serviceStaking.fetchKeleOpHistory({accountId:n,networkId:t}),D.default.serviceStaking.getDashboardGlobal({networkId:t})}),[]);var o=(0,s.useCallback)((function(e){var t=e.item,n=e.index;return(0,x.jsxs)(h.default,{py:"4",px:"6",bg:"surface-default",overflow:"hidden",borderTopRadius:0===n?12:void 0,borderBottomRadius:r&&n===r.length-1?12:void 0,children:[t.op?(0,x.jsx)(yt,{item:t.op}):null,t.income?(0,x.jsx)(xt,{item:t.income}):null]})}),[r]);return(0,x.jsx)(a.default,{height:"560px",footer:null,flatListProps:{data:null!=r?r:[],renderItem:o,ListHeaderComponent:gt,ListEmptyComponent:wt,ItemSeparatorComponent:ot.default,showsVerticalScrollIndicator:!1}})}},{name:w.StakingRoutes.UnstakeAmount,component:function(){var e,t,n,r,o=(0,l.default)(),i=((0,z.default)().height,(0,d.useNavigation)()),u=(0,d.useRoute)().params,c=u.networkId,m=u.tokenIdOnNetwork,g=u.accountId,y=ee(c),v=Y(c,g),k=J(c,g),j=(0,L.useSimpleTokenPriceValue)({networkId:c}),_=null!=(e=null==v?void 0:v.amount.retail_staked)?e:"0",O=null!=(t=null==y?void 0:y.retail_min_amount)?t:"0",C=null!=(n=null==k?void 0:k.estimate_use_sec)?n:60,P=te(Math.floor(C/60)),H=(0,s.useState)(""),$=(0,M.default)(H,2),U=$[0],V=$[1],K=(0,L.useSingleToken)(c,null!=m?m:"").token,Q=(0,s.useMemo)((function(){if(!K||!U)return"error";var e=new(B())(U),t=new(B())(_),n=K.symbol;return e.isNaN()||t.isNaN()||t.isLessThan(e)?o.formatMessage({id:"form__amount_invalid"},{0:n}):void 0}),[U,o,_,K]),W=(0,s.useMemo)((function(){var e,t=new(B())(O),n=!t.isNaN()&&t.gt("0"),r=null!=(e=null==K?void 0:K.symbol)?e:"";if(n){var a=U.trim(),i=new(B())(a);if(a&&(i.isNaN()||i.gt(0)&&i.lt(t)))return`${o.formatMessage({id:"form__min_amount"})} ${t.toFixed()} ${r}`}}),[O,U,o,K]),G=((0,s.useMemo)((function(){return new RegExp("^(0|([1-9][0-9]*))?\\.?([0-9]{1,18})?$")}),[]),(0,s.useCallback)((function(e){var t=new(B())(_);if(!t.lte(0)){var n=e>=100?_:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);V(n)}}),[_]));return(0,x.jsx)(a.default,{header:o.formatMessage({id:"title__unstake_str"},{0:null==K?void 0:K.symbol.toUpperCase()}),headerDescription:"Kelepool",primaryActionTranslationId:"action__next",hideSecondaryAction:!0,primaryActionProps:{isDisabled:!!Q||!!W||new(B())(U).lte(0)},onPrimaryActionPress:(0,T.default)((function*(){if(g&&K){var e=yield D.default.engine.getAccount(g,c),t={unstake_amt:U,address:e.address,type:"retail"},n={sign_time:Math.floor(Date.now()/1e3),token:"eth",addr:e.address,url:"/eth2/v2/miner/unstake",method:"post",api_param:t};i.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SignMessageConfirm,params:{accountId:e.id,networkId:K.networkId,unsignedMessage:{type:1,message:JSON.stringify(n)},onSuccess:function(){var e=(0,T.default)((function*(e){var r=yield D.default.serviceStaking.unstake(qt(qt({},t),{},{networkId:K.networkId,pirvSignRaw:JSON.stringify(n),signHash:e}));0!==r.code&&r.message?S.default.show({title:r.message},{type:"error"}):(V(""),D.default.serviceStaking.fetchMinerOverview({networkId:c,accountId:g}),i.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.Feedback,params:{networkId:c,accountId:g}}}))}));return function(t){return e.apply(this,arguments)}}()}}})}})),children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsxs)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsxs)(A.default,{flex:"1",flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flex:"1",maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:null!=(r=null==K?void 0:K.symbol.toUpperCase())?r:""}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:U,onChangeText:V,placeholder:"0"})}),(0,x.jsx)(A.default,{children:W?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:W}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=j?j:0,null!=U?U:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:j?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{children:[(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return G(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return G(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return G(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return G(100)},children:o.formatMessage({id:"action__max"})})]}),(0,x.jsxs)(h.default,{h:"8",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:o.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:Q&&U?"text-critical":"text-default",children:[null!=_?_:""," ",null==K?void 0:K.symbol.toUpperCase()]})]})]})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:o.formatMessage({id:"form__est_arrival_time"})}),(0,x.jsx)(p.default.Body2,{children:P})]})]}),!1]})})}},{name:w.StakingRoutes.KeleEthUnstakeShouldUnderstand,component:function(){var e=(0,l.default)(),t=(0,d.useNavigation)(),n=(0,d.useRoute)().params,r=(0,s.useCallback)((function(){n.readonly?t.goBack():t.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.UnstakeAmount,params:{accountId:n.accountId,networkId:n.networkId}}})}),[t,n]);return(0,x.jsx)(a.default,{header:e.formatMessage({id:"title__unstake_eth"}),hideSecondaryAction:!0,primaryActionTranslationId:"action__i_got_it",onPrimaryActionPress:r,scrollViewProps:{children:(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(A.default,{p:"6",children:[(0,x.jsx)(g.default,{w:"24",h:"24",source:xe}),(0,x.jsx)(p.default.DisplayLarge,{mt:"6",mb:"2",children:e.formatMessage({id:"title__unstake_eth"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__the_unstaking_process_will_be_completed_in_two_stages"})})]}),(0,x.jsxs)(h.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",children:[(0,x.jsx)(A.default,{w:"8",h:"8",borderRadius:"full",bg:"decorative-surface-one",mr:"4",children:(0,x.jsx)(p.default.Body2Strong,{color:"decorative-icon-one",children:"1"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"action__unstake"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__unstake_desc"})})]})]}),(0,x.jsxs)(h.default,{flexDirection:"row",mt:"5",children:[(0,x.jsx)(A.default,{w:"8",h:"8",borderRadius:"full",bg:"decorative-surface-one",mr:"4",children:(0,x.jsx)(p.default.Body2Strong,{color:"decorative-icon-one",children:"2"})}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(p.default.Body1Strong,{children:e.formatMessage({id:"action__withdraw"})}),(0,x.jsx)(p.default.Body2,{color:"text-subdued",textBreakStrategy:"highQuality",children:e.formatMessage({id:"form__withdraw_desc"})})]})]})]})]})}})}},{name:w.StakingRoutes.WithdrawAmount,component:function(){var e,t,n,r,o=(0,l.default)(),u=(0,c.useNavigation)(),m=(0,d.useRoute)(),g=((0,z.default)().height,m.params),y=g.networkId,v=g.tokenIdOnNetwork,k=g.accountId,j=(0,c.useAccount)({accountId:k,networkId:y}).account,_=Z(y,k),O=(0,L.useSimpleTokenPriceValue)({networkId:y}),C=null!=(e=null==_?void 0:_.balance)?e:"0",P=null!=(t=null==_?void 0:_.user_fee)?t:"0",H=(0,s.useState)(""),$=(0,M.default)(H,2),U=$[0],V=$[1],K=(0,L.useSingleToken)(y,null!=v?v:"").token,Q=(0,s.useMemo)((function(){var e=new(B())(U),t=new(B())(P),n=e.minus(t);if(n.gt(0))return(0,f.formatAmount)(n,8)}),[U,P]),W=(0,s.useMemo)((function(){if(!K||!U)return"error";var e=new(B())(U),t=new(B())(C),n=K.symbol;return e.isNaN()||t.isNaN()||t.isLessThan(e)?o.formatMessage({id:"form__amount_invalid"},{0:n}):void 0}),[U,o,C,K]),G=(0,s.useMemo)((function(){var e,t=new(B())(P),n=!t.isNaN()&&t.gt("0"),r=U.trim(),a=null!=(e=null==K?void 0:K.symbol)?e:"";if(n&&r){var i=new(B())(r);if(i.isNaN()||i.gt(0)&&i.lte(t))return`${o.formatMessage({id:"form__field_large_than"},{0:`${t.toFixed()} ${a}`})}`}}),[P,U,o,K]),X=(0,s.useCallback)((function(e){var t=new(B())(C);if(!t.lte(0)){var n=e>=100?C:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);V(n)}}),[C]);return(0,s.useMemo)((function(){return new RegExp("^(0|([1-9][0-9]*))?\\.?([0-9]{1,18})?$")}),[]),(0,x.jsx)(a.default,{header:o.formatMessage({id:"action__withdraw"}),primaryActionTranslationId:"action__next",hideSecondaryAction:!0,primaryActionProps:{isDisabled:!!W||!!G||new(B())(U).lte(0)},onPrimaryActionPress:(0,T.default)((function*(){if(k&&K){var e=yield D.default.engine.getAccount(k,y),t={token:"eth",amount:U,address:e.address};u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SignMessageConfirm,params:{accountId:k,networkId:K.networkId,unsignedMessage:{type:1,message:JSON.stringify(t)},onSuccess:function(){var e=(0,T.default)((function*(){var e=yield D.default.serviceStaking.withdraw({accountId:k,networkId:y,amount:U});0!==e.code&&e.message?S.default.show({title:e.message},{type:"error"}):(V(""),D.default.serviceStaking.fetchPendingWithdrawAmount({accountId:k,networkId:y}),u.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.Feedback,params:{networkId:y,accountId:k}}}))}));return function(){return e.apply(this,arguments)}}()}}})}})),children:(0,x.jsxs)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsxs)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsxs)(A.default,{flex:1,flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flex:1,maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:null!=(n=null==K?void 0:K.symbol.toUpperCase())?n:""}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:U,onChangeText:V,placeholder:"0"})}),(0,x.jsx)(A.default,{children:G?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:G}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=O?O:0,null!=U?U:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:O?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{children:[(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(100)},children:o.formatMessage({id:"action__max"})})]}),(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",justifyContent:"center",h:"8",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:o.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:W&&U?"text-critical":"text-default",children:[(0,f.formatAmount)(C,8)," ",null==K?void 0:K.symbol.toUpperCase()]})]})]})]}),(0,x.jsxs)(i.default,{space:"1",children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:o.formatMessage({id:"content__gas_fee"})}),(0,x.jsxs)(p.default.Body2,{children:[P," ",null==K?void 0:K.symbol.toUpperCase()]})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:o.formatMessage({id:"form__receive_address"})}),(0,x.jsx)(p.default.Body2,{children:(0,Ut.shortenAddress)(null!=(r=null==j?void 0:j.address)?r:"")})]}),Q?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:o.formatMessage({id:"form__actual_arrival"})}),(0,x.jsx)(p.default.Body2,{children:Q})]}):null]})]}),!1]})})}},{name:w.StakingRoutes.Feedback,component:fe},{name:w.StakingRoutes.ETHPoolSelector,component:v},{name:w.StakingRoutes.LidoEthStakeShouldUnderstand,component:Ie},{name:w.StakingRoutes.LidoEthUnstakeShouldUnderstand,component:Pe},{name:w.StakingRoutes.ETHStake,component:function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.accountId,o=n.networkId,i=n.source,g=(0,d.useNavigation)(),y=(0,L.useSimpleTokenPriceValue)({networkId:o}),v=(0,s.useState)(null!=i?i:w.EthStakingSource.Lido),O=(0,M.default)(v,2),P=O[0],z=O[1],K=(0,s.useState)(w.KeleStakingMode.fast),Q=(0,M.default)(K,2),W=Q[0],G=Q[1],X=(0,s.useState)(!1),J=(0,M.default)(X,2),Z=J[0],Y=J[1],ee=function(e,t){var n=(0,c.useAppSelector)((function(e){return e.staking.ethStakingApr}));if(!n)return"";var r=t?null==n?void 0:n.testnet:n.mainnet;return e===w.EthStakingSource.Kele?(0,U.formatAmount)(r.kele,2):(0,U.formatAmount)(r.lido,2)}(P,o===u.OnekeyNetwork.goerli);(0,s.useEffect)((function(){ee||D.default.serviceStaking.fetchEthAprSma()}),[]);var te=(0,s.useState)(""),ne=(0,M.default)(te,2),re=ne[0],oe=ne[1],ae=(0,L.useSingleToken)(o,"").token,le=(0,c.useTokenBalanceWithoutFrozen)({networkId:o,accountId:r,token:ae,fallback:"0"}),ce=(0,s.useMemo)((function(){if(!ae||!re)return"error";var e=new(B())(re),n=new(B())(le),r=ae.symbol;return e.isNaN()||n.isNaN()||n.isLessThan(e)?t.formatMessage({id:"form__amount_invalid"},{0:r}):void 0}),[re,t,le,ae]),fe=(0,s.useMemo)((function(){var e,n=P===w.EthStakingSource.Kele?new(B())("0.01"):new(B())("0.0000001"),r=!n.isNaN()&&n.gt("0"),o=null!=(e=null==ae?void 0:ae.symbol)?e:"";if(r){var a=re.trim(),i=new(B())(a);if(a&&(i.isNaN()||i.gt(0)&&i.lt(n)))return`${t.formatMessage({id:"form__min_amount"})} ${n.toFixed()} ${o}`}}),[re,t,ae,P]),me=(0,s.useCallback)((function(e){var t=new(B())(le);if(!t.lte(0)){var n=e>=100?le:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);oe(n)}}),[le]),pe=(0,s.useCallback)((function(){g.push(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.ETHPoolSelector,params:{networkId:o,accountId:r,onSelector:function(e){z(e);var t=g.getParent();t?t.goBack():g.goBack()}}}})}),[g,o,r]),he=(0,s.useCallback)((function(){g.push(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.KeleStakingModeSelector,params:{mode:W,networkId:o,onSelector:function(e){G(e);var t=g.getParent();t?t.goBack():g.goBack()}}}})}),[g,o,W]),ge=(0,s.useCallback)(function(){var e=(0,T.default)((function*(e){var n=e.stakingTx,a=e.onClose;if(n){var i,s=yield D.default.engine.getAccount(r,o);n&&(i=ie(ie({},n),{},{from:s.address})),i?ae&&(null==a||a(),yield D.default.serviceStaking.registerOnKele({payeeAddr:s.address,networkId:o}),g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SendConfirm,params:{networkId:o,accountId:r,payloadInfo:{type:"InternalStake",stakeInfo:{tokenInfo:ae,amount:re,accountAddress:s.address}},feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:ie(ie({},i),{},{from:null==s?void 0:s.address}),onSuccess:function(e,n){var a,i;P===w.EthStakingSource.Kele?D.default.dispatch((0,H.addKeleTransaction)({accountId:s.id,networkId:o,transaction:{hash:e.txid,accountId:s.id,networkId:o,type:"KeleStake",amount:re,nonce:null==n||null==(a=n.decodedTx)?void 0:a.nonce,addedTime:Date.now()}})):(D.default.serviceStaking.addStEthToUserAccount({networkId:o,accountId:r}),D.default.dispatch((0,H.addTransaction)({accountId:s.id,networkId:o,transaction:{hash:e.txid,accountId:s.id,networkId:o,type:"lidoStake",nonce:null==n||null==(i=n.decodedTx)?void 0:i.nonce,addedTime:Date.now()}})));S.default.show({title:t.formatMessage({id:"msg__success"})}),g.goBack()}}}})):S.default.show({title:"Failed to build encodedTx data"},{type:"error"})}else S.default.show({title:"Failed to build encodedTx data"},{type:"error"})}));return function(t){return e.apply(this,arguments)}}(),[ae,r,re,t,g,o,P]),xe=(0,s.useCallback)(function(){var e=(0,T.default)((function*(e){var t=e.onClose;if(r&&ae){var n,a=new(B())(re).shiftedBy(ae.decimals).toFixed(0);try{if(Y(!0),P===w.EthStakingSource.Kele)if(W===w.KeleStakingMode.fast){var i=yield D.default.serviceStaking.prepareBuildTxForFastStakingToKele({value:a,networkId:o});if((0,U.gt)(re,i.fast_stake_balance)){var s=(0,U.minus)(re,i.fast_stake_balance).toString();return void(0,$.showOverlay)((function(e){return(0,x.jsx)(ue,{amount:re,remain:s,closeOverlay:e,onConfirm:(0,T.default)((function*(){var e=i.fund_addr;yield D.default.validator.validateAddress(o,e),n=yield D.default.serviceStaking.buildTxForFastStakingETHtoKele({value:a,networkId:o,accountId:r}),ge({stakingTx:n,onClose:t})}))})}))}var d=i.fund_addr;yield D.default.validator.validateAddress(o,d),n=yield D.default.serviceStaking.buildTxForFastStakingETHtoKele({value:a,networkId:o,accountId:r})}else n=yield D.default.serviceStaking.buildTxForStakingETHtoKele({value:a,networkId:o});else n=yield D.default.serviceStaking.buildTxForStakingETHtoLido({value:a,networkId:o})}catch(l){return void S.default.show({title:l.message},{type:"error"})}finally{Y(!1)}ge({stakingTx:n,onClose:t})}}));return function(t){return e.apply(this,arguments)}}(),[P,ae,o,r,re,W,ge]);return(0,x.jsx)(a.default,{header:t.formatMessage({id:"title__stake_str"},{0:null==ae?void 0:ae.symbol.toUpperCase()}),primaryActionTranslationId:"action__stake",hideSecondaryAction:!0,primaryActionProps:{isLoading:Z,isDisabled:!!ce||!!fe||new(B())(re).lte(0)},onPrimaryActionPress:xe,children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:(0,x.jsxs)(A.default,{flex:"1",flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flexGrow:"1",maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:null!=(e=null==ae?void 0:ae.symbol.toUpperCase())?e:""}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:re,onChangeText:oe,placeholder:"0"})}),(0,x.jsx)(A.default,{children:fe?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:fe}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=y?y:0,null!=re?re:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:y?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{flexGrow:"0.5",flexShrink:"1",flexDirection:"column",children:[(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return me(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return me(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return me(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return me(100)},children:t.formatMessage({id:"action__max"})})]}),(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(h.default,{h:"8",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:t.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:ce&&re?"text-critical":"text-default",children:[(0,f.formatAmount)(null!=le?le:"",6)," ",null==ae?void 0:ae.symbol.toUpperCase()]})]})]}),(0,x.jsxs)(h.default,{w:"full",flexGrow:"0.5",flexShrink:"1",children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__apy"})}),ee?(0,x.jsxs)(p.default.Body2,{color:"text-success",children:[ee,"%"]}):(0,x.jsx)(h.default,{w:"6",h:"4",overflow:"hidden",borderRadius:12,children:(0,x.jsx)(_.default,{})})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__protocol"})}),(0,x.jsx)(m.default,{onPress:pe,children:(0,x.jsx)(se,{source:P})})]}),P===w.EthStakingSource.Kele?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsxs)(h.default,{flexDirection:"row",alignItems:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"content__mode"})}),(0,x.jsx)(h.default,{ml:"2",children:(0,x.jsx)(k.default,{trigger:function(e){var t=Object.assign({},((0,j.default)(e),e));return(0,x.jsx)(m.default,ie(ie({},t),{},{children:(0,x.jsx)(C.default,{name:"QuestionMarkCircleOutline",size:16,color:"icon-subdued"})}))},bodyProps:{children:(0,x.jsx)(b.default,{children:t.formatMessage({id:"msg__send_tokens_to_the_system_s_financing_address"})})}})})]}),(0,x.jsx)(m.default,{onPress:he,children:(0,x.jsx)(de,{mode:W})})]}):null]})]})}),(0,x.jsx)(V,{text:re,onTextChange:oe})]})})}},{name:w.StakingRoutes.StakedETHOnLido,component:function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,r=t.networkId,o=t.accountId;(0,s.useEffect)((function(){D.default.serviceStaking.fetchLidoOverview({networkId:r,accountId:o}),D.default.serviceStaking.fetchEthAprSma()}),[]);var i=re(r,o),u=(0,s.useMemo)((function(){return i?(i.nfts?(0,vt.default)(i.nfts):[]).sort((function(e,t){return t.requestId-e.requestId})):[]}),[i]),c=(0,s.useCallback)((function(t){var r=t.item,o=t.index;return(0,x.jsx)(h.default,{py:"4",overflow:"hidden",borderTopRadius:0===o?12:void 0,borderBottomRadius:u&&o===u.length-1?12:void 0,flexDirection:"row",justifyContent:"space-between",children:(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",w:"full",children:[(0,x.jsx)(g.default,{w:"8",h:"8",borderRadius:"full",source:n(296914),mr:"2"}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsxs)(h.default,{w:"full",flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{mr:"2",children:e.formatMessage({id:"action_unstake"})}),(0,x.jsxs)(p.default.Body1Strong,{isTruncated:!0,children:["+",It(r.stETH),"ETH"]})]}),(0,x.jsxs)(h.default,{w:"full",flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__est_str"},{0:e.formatMessage({id:"form__str_day"},{0:" 1 - 5"})})}),(0,x.jsx)(p.default.Body2,{color:"text-highlight",children:r.isFinalized?e.formatMessage({id:"form__available_for_claim"}):e.formatMessage({id:"transaction__pending"})})]})]})]})})}),[u,e]);return(0,x.jsx)(a.default,{height:"560px",footer:null,flatListProps:{data:u,renderItem:c,ListHeaderComponent:Tt,ListEmptyComponent:Mt,keyExtractor:function(e){return String(e.requestId)},ItemSeparatorComponent:ot.default,showsVerticalScrollIndicator:!1},children:(0,x.jsx)(Tt,{})})}},{name:w.StakingRoutes.LidoEthUnstake,component:function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,u=(0,d.useNavigation)(),g=(0,L.useSimpleTokenPriceValue)({networkId:r}),y=re(r,o),v=null!=(e=null==y?void 0:y.balance)?e:"0",k="stETH",j=(0,c.useAppSelector)((function(e){return e.staking.stEthRate})),_=(0,s.useState)("lido"),O=(0,M.default)(_,2),C=O[0],P=O[1],$=(0,s.useState)(""),U=(0,M.default)($,2),z=U[0],K=U[1],Q=(0,s.useState)(!1),W=(0,M.default)(Q,2),G=W[0],X=W[1],J=(0,Se.useSwapSubmit)(),Z=(0,s.useMemo)((function(){if(!z)return"error";var e=new(B())(z),n=new(B())(v);return e.isNaN()||n.isNaN()||n.isLessThan(e)?t.formatMessage({id:"form__amount_invalid"},{0:k}):void 0}),[z,t,v,k]),Y=(0,s.useMemo)((function(){var e="lido"===C?new(B())(1e-7):new(B())(1e-9),n=z.trim(),r=new(B())(n);if(e.gt(0)&&n&&(r.isNaN()||r.gt(0)&&r.lt(e)))return`${t.formatMessage({id:"form__min_amount"})} ${e.toFixed()} ${k}`}),[z,t,k,C]),ee=(0,s.useCallback)((function(e){var t=new(B())(v);if(!t.lte(0)){var n=e>=100?v:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);K(n)}}),[v]),te=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.engine.getAccount(o,r);if(e&&r){var n=yield(0,Te.buildWithdrawStEthTransaction)({networkId:r,account:e,typedValue:z}),a=n.params,i=n.quote;yield J({params:a,quote:i,recipient:e,onSuccess:function(){var n=(0,T.default)((function*(n){var a=n.result,i=n.decodedTx;D.default.dispatch((0,H.addTransaction)({accountId:e.id,networkId:r,transaction:{hash:a.txid,accountId:e.id,networkId:r,type:"lidoUnstake",nonce:null==i?void 0:i.nonce,addedTime:Date.now()}})),u.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.StakedETHOnLido,params:{accountId:o,networkId:r}}}),S.default.show({title:t.formatMessage({id:"msg__success"})})}));return function(e){return n.apply(this,arguments)}}()})}})),[r,z,J,u,t,o]),ne=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.serviceStaking.getStEthToken({networkId:r}),n=new(B())(z).shiftedBy(e.decimals).toFixed(0),a=Math.floor(Date.now()/1e3)+86400,i=yield D.default.serviceStaking.buildStEthPermit({accountId:o,networkId:r,value:n,deadline:a});i?u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SignMessageConfirm,params:{accountId:o,networkId:r,hideToast:!0,unsignedMessage:{type:4,message:i},closeImmediately:!0,onSuccess:function(){var e=(0,T.default)((function*(e){var i=`0x${e.substring(2).substring(0,64)}`,s=`0x${e.substring(2).substring(64,128)}`,d=parseInt(e.substring(2).substring(128,130),16),l=yield D.default.engine.getAccount(o,r),c=Oe(Oe({},yield D.default.serviceStaking.buildRequestWithdrawalsWithPermit({networkId:r,amounts:[n],owner:l.address,permit:{v:d,s:s,r:i,value:n,deadline:a}})),{},{from:l.address});setTimeout((function(){u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SendConfirm,params:{accountId:l.id,networkId:r,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:c,onSuccess:function(e,n){var a;S.default.show({title:t.formatMessage({id:"msg__success"})}),D.default.dispatch((0,H.addTransaction)({accountId:l.id,networkId:r,transaction:{hash:e.txid,accountId:l.id,networkId:r,type:"lidoUnstake",nonce:null==n||null==(a=n.decodedTx)?void 0:a.nonce,addedTime:Date.now()}})),u.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.StakedETHOnLido,params:{accountId:o,networkId:r}}})}}}})}),10)}));return function(t){return e.apply(this,arguments)}}()}}}):S.default.show({title:t.formatMessage({id:"form__failed"})},{type:"error"})})),[r,z,u,t,o]),oe=(0,s.useCallback)((0,T.default)((function*(){try{X(!0),"onekey"===C?yield te():yield ne()}finally{X(!1)}})),[C,te,ne]),ae=(0,s.useCallback)((function(){u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoEthUnstakeRoutes,params:{source:C,amount:z,accountId:o,networkId:r,onSelector:function(e){P(e),u.goBack()}}}})}),[C,u,z,r,o]),ie=(0,s.useMemo)((function(){if("lido"!==C)return null==j?void 0:j[r]}),[C,j,r]);return(0,x.jsx)(a.default,{header:t.formatMessage({id:"title__unstake_str"},{0:k}),headerDescription:"Lido",primaryActionTranslationId:"action__next",hideSecondaryAction:!0,primaryActionProps:{isDisabled:!!Z||new(B())(z).lte(0),onPress:oe,isLoading:G},children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsxs)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsxs)(A.default,{flex:"1",flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flex:"1",maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:k}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:z,onChangeText:K,placeholder:"0"})}),(0,x.jsx)(A.default,{children:Y?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:Y}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=g?g:0,null!=z?z:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:g?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{children:[(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(100)},children:t.formatMessage({id:"action__max"})})]}),(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(h.default,{h:"8",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:t.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:Z&&z?"text-critical":"text-default",children:[(0,f.formatAmount)(null!=v?v:"",6)," ",k]})]})]})]}),(0,x.jsxs)(i.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__est_arrival_time"})}),(0,x.jsx)(p.default.Body2Strong,{children:"lido"===C?t.formatMessage({id:"form__str_day"},{0:"~ 1 - 3"}).toLowerCase():t.formatMessage({id:"content__str_minutes_plural"},{0:"~ 1-5"})})]}),(0,x.jsx)(be.Hidden,{children:ie?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__est_receipt"})}),(0,x.jsxs)(p.default.Body2Strong,{children:[new(B())(ie).multipliedBy(z).toFixed(),"ETH"]})]}):null}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__route"})}),(0,x.jsx)(m.default,{onPress:ae,children:(0,x.jsx)(Re,{value:C})})]})]})]}),(0,x.jsx)(V,{text:z,onTextChange:K})]})})}},{name:w.StakingRoutes.LidoEthUnstakeRoutes,component:Ae},{name:w.StakingRoutes.LidoUnstakeRoutes,component:Xe},{name:w.StakingRoutes.KeleStakingModeSelector,component:ve},{name:w.StakingRoutes.MaticStake,component:function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.accountId,o=n.networkId,i=(0,Ze.useSwapSend)(),u=oe(o,r),m=(0,W.getMaticContractAdderess)(o),g=(0,d.useNavigation)(),y=(0,L.useSimpleTokenPriceValue)({networkId:o,contractAdress:m}),w=(0,s.useState)(!1),v=(0,M.default)(w,2),k=v[0],j=v[1],_=(0,s.useState)(""),O=(0,M.default)(_,2),C=O[0],P=O[1],$=(0,L.useSingleToken)(o,m).token,z=(0,c.useTokenBalanceWithoutFrozen)({networkId:o,accountId:r,token:$,fallback:"0"}),K=(0,s.useMemo)((function(){if(!$||!C)return"error";var e=new(B())(C),n=new(B())(z),r=$.symbol;return e.isNaN()||n.isNaN()||n.isLessThan(e)?t.formatMessage({id:"form__amount_invalid"},{0:r}):void 0}),[C,t,z,$]),G=(0,s.useMemo)((function(){var e,n=new(B())("0.0000001"),r=!n.isNaN()&&n.gt("0"),o=null!=(e=null==$?void 0:$.symbol)?e:"";if(r){var a=C.trim(),i=new(B())(a);if(a&&(i.isNaN()||i.gt(0)&&i.lt(n)))return`${t.formatMessage({id:"form__min_amount"})} ${n.toFixed()} ${o}`}}),[C,t,$]),X=(0,s.useCallback)((function(e){var t=new(B())(z);if(!t.lte(0)){var n=e>=100?z:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);P(n)}}),[z]),J=(0,s.useCallback)(function(){var e=(0,T.default)((function*(e){var n=e.onClose;if(r&&$)try{j(!0);var a,s=(0,Q.getWalletIdFromAccountId)(r),d=yield D.default.engine.getWallet(s),l=new(B())(C).shiftedBy($.decimals).toFixed(0),u=!1,c=yield D.default.serviceStaking.buildTxForStakingMaticToLido({amount:l,networkId:o,accountId:r}),f=yield D.default.engine.getTokenAllowance({networkId:o,accountId:r,tokenIdOnNetwork:m,spender:c.to});f&&(u=new(B())((0,U.getTokenAmountString)($,f)).lt(l)),u&&(a=yield D.default.engine.buildEncodedTxFromApprove({spender:c.to,networkId:o,accountId:r,token:m,amount:C}));var p=[],h=function(){var e=(0,T.default)((function*(){var e=yield D.default.engine.getAccount(r,o),n=et(et({},c),{},{from:e.address});yield i({accountId:r,networkId:o,gasEstimateFallback:!0,encodedTx:n,showSendFeedbackReceipt:!0,onSuccess:function(){var n=(0,T.default)((function*(n){var r=n.result,a=n.decodedTx;S.default.show({title:t.formatMessage({id:"msg__success"})}),D.default.dispatch((0,H.addTransaction)({accountId:e.id,networkId:o,transaction:{hash:r.txid,accountId:e.id,networkId:o,type:"lidoStakeMatic",nonce:null==a?void 0:a.nonce,addedTime:Date.now()}}))}));return function(e){return n.apply(this,arguments)}}(),onFail:function(){Je.appUIEventBus.emit(Je.AppUIEventBusNames.SwapError)}})}));return function(){return e.apply(this,arguments)}}();if(p.unshift(h),a){var x=function(){var e=(0,T.default)((function*(e){yield i({accountId:r,networkId:o,encodedTx:a,onSuccess:function(){var t=(0,T.default)((function*(){"hw"===d.type&&g.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.HardwareSwapContinue,params:{networkId:o,accountId:r}}}),yield null==e?void 0:e()}));return function(){return t.apply(this,arguments)}}()})}));return function(t){return e.apply(this,arguments)}}();p.unshift(x)}null==n||n(),yield(0,U.combinedTasks)(p),g.goBack()}catch(y){return void S.default.show({title:y.message},{type:"error"})}finally{j(!1)}}));return function(t){return e.apply(this,arguments)}}(),[$,o,r,C,m,i,g,t]);return(0,x.jsx)(a.default,{header:t.formatMessage({id:"title__stake_str"},{0:null==$?void 0:$.symbol.toUpperCase()}),primaryActionTranslationId:"action__stake",hideSecondaryAction:!0,primaryActionProps:{isLoading:k,isDisabled:!!K||!!G||new(B())(C).lte(0)},onPrimaryActionPress:J,children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsx)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:(0,x.jsxs)(A.default,{flex:"1",flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flexGrow:"1",maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:null!=(e=null==$?void 0:$.symbol.toUpperCase())?e:""}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:C,onChangeText:P,placeholder:"0"})}),(0,x.jsx)(A.default,{children:G?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:G}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=y?y:0,null!=C?C:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:y?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{flexGrow:"0.5",flexShrink:"1",flexDirection:"column",children:[(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return X(100)},children:t.formatMessage({id:"action__max"})})]}),(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(h.default,{h:"8",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:t.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:K&&C?"text-critical":"text-default",children:[(0,f.formatAmount)(null!=z?z:"",6)," ",null==$?void 0:$.symbol.toUpperCase()]})]})]}),(0,x.jsxs)(h.default,{w:"full",flexGrow:"0.5",flexShrink:"1",children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__apy"})}),(0,x.jsx)(p.default.Body2,{color:"text-success",children:"4.3%"})]}),null!=u&&u.maticToStMaticRate?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__rate"})}),(0,x.jsxs)(p.default.Body2,{children:["1 Matic = ",(0,f.formatAmount)(u.maticToStMaticRate,4)," ","stMatic"]})]}):null,null!=u&&u.maticToStMaticRate&&C?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__you_receive"})}),(0,x.jsxs)(p.default.Body2,{children:[(0,f.formatAmount)((0,U.multiply)(u.maticToStMaticRate,C),4)," ","stMatic"]})]}):null]})]})}),(0,x.jsx)(V,{text:C,onTextChange:P})]})})}},{name:w.StakingRoutes.StakedMaticOnLido,component:function(){var e=(0,l.default)(),t=(0,d.useRoute)().params,r=t.networkId,o=t.accountId;(0,s.useEffect)((function(){D.default.serviceStaking.fetchLidoMaticOverview({networkId:r,accountId:o})}),[]);var i=oe(r,o),u=(0,s.useMemo)((function(){return i?(i.nfts?(0,vt.default)(i.nfts):[]).sort((function(e,t){return t.nftId-e.nftId})):[]}),[i]),c=(0,s.useCallback)((function(t){var r=t.item,o=t.index;return(0,x.jsx)(h.default,{py:"4",overflow:"hidden",borderTopRadius:0===o?12:void 0,borderBottomRadius:u&&o===u.length-1?12:void 0,flexDirection:"row",justifyContent:"space-between",children:(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",w:"full",children:[(0,x.jsx)(g.default,{w:"8",h:"8",borderRadius:"full",source:n(296914),mr:"2"}),(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsxs)(h.default,{w:"full",flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body1Strong,{mr:"2",children:e.formatMessage({id:"action_unstake"})}),(0,x.jsxs)(p.default.Body1Strong,{isTruncated:!0,children:["+",At(r.maticAmount),"MATIC"]})]}),(0,x.jsxs)(h.default,{w:"full",flexDirection:"row",justifyContent:"space-between",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:e.formatMessage({id:"form__est_str"},{0:e.formatMessage({id:"form__str_day"},{0:" 3 - 4"})})}),(0,x.jsx)(p.default.Body2,{color:"text-highlight",children:r.claimable?e.formatMessage({id:"form__available_for_claim"}):e.formatMessage({id:"transaction__pending"})})]})]})]})})}),[u,e]);return(0,x.jsx)(a.default,{height:"560px",footer:null,flatListProps:{data:u,renderItem:c,ListHeaderComponent:Bt,ListEmptyComponent:Dt,keyExtractor:function(e){return String(e.nftId)},ItemSeparatorComponent:ot.default,showsVerticalScrollIndicator:!1},children:(0,x.jsx)(Bt,{})})}},{name:w.StakingRoutes.LidoMaticUnstake,component:function(){var e,t=(0,l.default)(),n=(0,d.useRoute)().params,r=n.networkId,o=n.accountId,u=(0,d.useNavigation)(),c=(0,L.useSimpleTokenPriceValue)({networkId:r,contractAdress:(0,W.getMaticContractAdderess)(r)}),g=oe(r,o),y=null!=(e=null==g?void 0:g.balance)?e:"0",v="stMatic",k=(0,s.useState)("lido"),j=(0,M.default)(k,2),_=j[0],O=j[1],C=(0,s.useState)(""),P=(0,M.default)(C,2),$=P[0],z=P[1],K=(0,s.useState)(!1),Q=(0,M.default)(K,2),G=Q[0],X=Q[1],J=(0,Se.useSwapSubmit)(),Z=(0,s.useMemo)((function(){if(!$)return"error";var e=new(B())($),n=new(B())(y);return e.isNaN()||n.isNaN()||n.isLessThan(e)?t.formatMessage({id:"form__amount_invalid"},{0:v}):void 0}),[$,t,y,v]),Y=(0,s.useMemo)((function(){var e="lido"===_?new(B())(1e-7):new(B())(1e-9),n=$.trim(),r=new(B())(n);if(e.gt(0)&&n&&(r.isNaN()||r.gt(0)&&r.lt(e)))return`${t.formatMessage({id:"form__min_amount"})} ${e.toFixed()} ${v}`}),[$,t,v,_]),ee=(0,s.useCallback)((function(e){var t=new(B())(y);if(!t.lte(0)){var n=e>=100?y:(0,f.formatAmount)(t.multipliedBy(e).dividedBy(100),8);z(n)}}),[y]),te=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.engine.getAccount(o,r);if(e&&r){var n=yield ze({networkId:r,accountId:o,value:$}),a=n.params,i=n.quote;yield J({params:a,quote:i,recipient:e,onSuccess:function(){var n=(0,T.default)((function*(n){var a=n.result,i=n.decodedTx;D.default.dispatch((0,H.addTransaction)({accountId:e.id,networkId:r,transaction:{hash:a.txid,accountId:e.id,networkId:r,type:"lidoUnstakeMatic",nonce:null==i?void 0:i.nonce,addedTime:Date.now()}})),u.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.StakedMaticOnLido,params:{accountId:o,networkId:r}}}),S.default.show({title:t.formatMessage({id:"msg__success"})})}));return function(e){return n.apply(this,arguments)}}()})}})),[r,$,J,u,t,o]),ne=(0,s.useCallback)((0,T.default)((function*(){var e=yield D.default.serviceStaking.getStEthToken({networkId:r}),n=new(B())($).shiftedBy(e.decimals).toFixed(0),a=yield D.default.engine.getAccount(o,r),i=Qe(Qe({},yield D.default.serviceStaking.buildTransactionUnstakeMatic({accountId:o,networkId:r,amount:n})),{},{from:a.address});setTimeout((function(){u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Send,params:{screen:q.SendModalRoutes.SendConfirm,params:{accountId:a.id,networkId:r,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:i,onSuccess:function(e,n){var i;S.default.show({title:t.formatMessage({id:"msg__success"})}),D.default.dispatch((0,H.addTransaction)({accountId:a.id,networkId:r,transaction:{hash:e.txid,accountId:a.id,networkId:r,type:"lidoUnstakeMatic",nonce:null==n||null==(i=n.decodedTx)?void 0:i.nonce,addedTime:Date.now()}})),u.replace(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.StakedMaticOnLido,params:{accountId:o,networkId:r}}})}}}})}),10)})),[r,$,u,t,o]),re=(0,s.useCallback)((0,T.default)((function*(){try{X(!0),"onekey"===_?yield te():yield ne()}finally{X(!1)}})),[_,te,ne]),ae=(0,s.useCallback)((function(){u.navigate(F.RootRoutes.Modal,{screen:F.ModalRoutes.Staking,params:{screen:w.StakingRoutes.LidoUnstakeRoutes,params:{source:_,amount:$,accountId:o,networkId:r,onSelector:function(e){O(e),u.goBack()}}}})}),[_,u,$,r,o]);return(0,x.jsx)(a.default,{header:t.formatMessage({id:"title__unstake_str"},{0:v}),headerDescription:"Lido",primaryActionTranslationId:"action__next",hideSecondaryAction:!0,primaryActionProps:{isDisabled:!!Z||new(B())($).lte(0),onPress:re,isLoading:G},children:(0,x.jsxs)(h.default,{flex:"1",children:[(0,x.jsxs)(h.default,{flex:"1",flexDirection:"column",justifyContent:"space-between",children:[(0,x.jsxs)(A.default,{flex:"1",flexDirection:"column",justifyContent:"space-around",children:[(0,x.jsxs)(A.default,{flex:"1",maxH:"140px",children:[(0,x.jsx)(b.default,{textAlign:"center",typography:"DisplayLarge",color:"text-subdued",children:v}),(0,x.jsx)(A.default,{flex:"1",minH:"30px",children:(0,x.jsx)(N.AutoSizeText,{autoFocus:!0,text:$,onChangeText:z,placeholder:"0"})}),(0,x.jsx)(A.default,{children:Y?(0,x.jsx)(p.default.Body1Strong,{color:"text-critical",children:Y}):(0,x.jsx)(E.FormatCurrency,{numbers:[null!=c?c:0,null!=$?$:0],render:function(e){return(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:c?e:"$ 0"})}})})]}),(0,x.jsxs)(A.default,{children:[(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(I.default,{flexDirection:"row",alignItems:"center",space:"3",children:[(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(25)},children:"25%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(50)},children:"50%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(75)},children:"75%"}),(0,x.jsx)(R.default,{size:"sm",onPress:function(){return ee(100)},children:t.formatMessage({id:"action__max"})})]}),(0,x.jsx)(h.default,{h:"1",flexShrink:"1"}),(0,x.jsxs)(h.default,{h:"8",flexDirection:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",mr:"1",children:t.formatMessage({id:"content__available_balance"})}),(0,x.jsxs)(p.default.Body2Strong,{color:Z&&$?"text-critical":"text-default",children:[(0,f.formatAmount)(null!=y?y:"",6)," ",v]})]})]})]}),(0,x.jsxs)(i.default,{children:[(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__est_arrival_time"})}),(0,x.jsx)(p.default.Body2Strong,{children:"lido"===_?t.formatMessage({id:"form__str_day"},{0:"~ 3 - 4"}).toLowerCase():t.formatMessage({id:"content__str_minutes_plural"},{0:"~ 1 - 5"})})]}),(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__route"})}),(0,x.jsx)(m.default,{onPress:ae,children:(0,x.jsx)(We,{value:_})})]}),null!=g&&g.maticToStMaticRate&&"lido"===_?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__rate"})}),(0,x.jsxs)(p.default.Body2,{children:["1 stMatic ="," ",(0,f.formatAmount)((0,U.div)(1,g.maticToStMaticRate),4)," ","Matic"]})]}):null,null!=g&&g.maticToStMaticRate&&$&&"lido"===_?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__you_receive"})}),(0,x.jsxs)(p.default.Body2,{children:[(0,f.formatAmount)((0,U.div)($,g.maticToStMaticRate),4)," ","Matic"]})]}):null,"onekey"===_?(0,x.jsxs)(h.default,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",h:"10",children:[(0,x.jsx)(p.default.Body2,{color:"text-subdued",children:t.formatMessage({id:"form__you_receive"})}),(0,x.jsx)(Ge,{value:$,networkId:r,accountId:o})]}):null]})]}),(0,x.jsx)(V,{text:$,onTextChange:z})]})})}},{name:w.StakingRoutes.LidoMaticClaim,component:Fe},{name:w.StakingRoutes.LidoMaticStakeShouldUnderstand,component:qe}];const Wt=function(){var e=(0,o.default)();return(0,x.jsx)(Kt.Navigator,{screenOptions:function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({headerShown:!1},(0,zt.buildModalStackNavigatorOptions)({isVerticalLayout:e,navInfo:t}))},children:Qt.map((function(e){return(0,x.jsx)(Kt.Screen,{name:e.name,component:e.component},e.name)}))})}},375814:(e,t,n)=>{n.r(t),n.d(t,{StakingTypes:()=>a,buildWithdrawStEthTransaction:()=>S,coingeckoId2StakingTypes:()=>g,fetchStEthRate:()=>I,getLidoTokenEvmAddress:()=>j,getRecommendNetworkIdByStakingType:()=>y,getStakeSelectNetworkAccountFilter:()=>w,getTransactionStakingType:()=>h,isAccountCompatibleWithStakingTypes:()=>v,isSTETH:()=>_,isSupportStakingType:()=>k});var r,o,a,i=n(634795),s=n(534756),d=n(942013),l=n(945821),u=n(556805),c=n(964253),f=[d.OnekeyNetwork.eth,d.OnekeyNetwork.goerli],m=[`${d.OnekeyNetwork.eth}--${c.MainnetMaticContractAddress}`,`${d.OnekeyNetwork.goerli}--${c.TestnetMaticContractAddress}`];!function(e){e.eth="eth",e.matic="matic"}(a||(a={}));var p=((r={})[a.eth]=["lidoClaim","lidoStake","lidoUnstake"],r[a.matic]=["lidoClaimMatic","lidoStakeMatic","lidoUnstakeMatic"],r),h=function(e){for(var t=Object.entries(p),n=0;n<t.length;n+=1){var r=t[n],o=r[0];if(r[1].includes(e))return o}},g={ethereum:a.eth,"matic-network":a.matic},x=((o={})[a.eth]=[d.OnekeyNetwork.eth,d.OnekeyNetwork.goerli],o[a.matic]=[d.OnekeyNetwork.eth,d.OnekeyNetwork.goerli],o),y=function(e){var t;return null==(t=x[e])?void 0:t[0]},w=function(e){var t=x[e];if(t&&0!==t.length)return function(e){var n=e.network;return!!n&&t.includes(n.id)}},v=function(e,t){var n=x[t];return!(!n||0===n.length)&&n.some((function(t){return(0,s.isAccountCompatibleWithNetwork)(e,t)}))},k=function(e){var t=function(e){var t=e.tokenIdOnNetwork,n=e.networkId;return n?t?`${n}--${t}`:`${n}`:""}({networkId:e.networkId,tokenIdOnNetwork:e.tokenIdOnNetwork});return f.includes(t)?a.eth:m.includes(t)?a.matic:void 0},j=function(e,t){if(e)return e!==d.OnekeyNetwork.goerli||t?e!==d.OnekeyNetwork.eth||t?void 0:c.MainnetLidoContractAddress:c.TestnetLidoContractAddress},_=function(e,t){return!(!e||!t)&&(e===d.OnekeyNetwork.goerli&&t.toLowerCase()===c.TestnetLidoContractAddress.toLowerCase()||e===d.OnekeyNetwork.eth&&t.toLowerCase()===c.MainnetLidoContractAddress.toLowerCase())};function I(e){return b.apply(this,arguments)}function b(){return(b=(0,i.default)((function*(e){var t=e.networkId,n=e.account,r=e.amount||"0.1",o=yield l.default.engine.getNativeTokenInfo(t),a=yield l.default.serviceStaking.getStEthToken({networkId:t}),i=yield l.default.engine.getNetwork(t),s={networkOut:i,networkIn:i,tokenOut:o,tokenIn:a,slippagePercentage:"1",typedValue:r,independentField:"INPUT",activeAccount:n,receivingAddress:n.address};return yield u.SwapQuoter.client.fetchQuote(s)}))).apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e){var t=e.networkId,n=e.account,r=e.typedValue,o=yield l.default.engine.getNativeTokenInfo(t),a=yield l.default.serviceStaking.getStEthToken({networkId:t}),i=yield l.default.engine.getNetwork(t),s={networkOut:i,networkIn:i,tokenOut:o,tokenIn:a,slippagePercentage:"1",typedValue:r,independentField:"INPUT",activeAccount:n,receivingAddress:n.address},d=yield u.SwapQuoter.client.fetchQuote(s),c=null==d?void 0:d.data;if(!c)throw new Error("failed to build unstake params");return{params:s,quote:c}}))).apply(this,arguments)}},690549:(e,t,n)=>{n.r(t),n.d(t,{SwapTransactionsCancelApprovalBottomSheetModal:()=>c});var r=n(259825),o=n(470310),a=n(321668),i=n(795116),s=n(10918),d=n(202784),l=n(783112),u=n(552322),c=function(e){var t=e.close,n=e.onSubmit,c=(0,l.default)(),f=(0,d.useCallback)((function(){t(),n()}),[t,n]);return(0,u.jsxs)(r.default,{closeOverlay:t,title:"",showHeader:!1,children:[(0,u.jsx)(i.default,{h:"64px",children:(0,u.jsx)(s.default.Heading,{fontSize:60,lineHeight:64,children:"\u2139\ufe0f"})}),(0,u.jsx)(s.default.DisplayMedium,{mt:"4",children:c.formatMessage({id:"msg__need_to_send_str_transactions_to_change_allowance"},{0:"2"})}),(0,u.jsx)(s.default.Body1,{color:"text-subdued",my:"4",children:c.formatMessage({id:"msg__modifying_the_authorized_limit_of_usdt_requires_resetting_it_to_zero_first_so_two_authorization_transactions_may_be_initiated"})}),(0,u.jsxs)(o.default,{flexDirection:"row",space:"4",children:[(0,u.jsx)(a.default,{size:"xl",type:"basic",onPress:t,flex:"1",children:c.formatMessage({id:"action__cancel"})}),(0,u.jsx)(a.default,{size:"xl",type:"primary",onPress:f,flex:"1",children:c.formatMessage({id:"action__confirm"})})]})]})}},797749:(e,t,n)=>{n.r(t),n.d(t,{useSwapSend:()=>p,useSwapSignMessage:()=>h});var r=n(634795),o=n(202784),a=n(534756),i=n(292147),s=(n(213208),n(945821)),d=n(493877),l=n(420454),u=n(481047),c=n(432986),f=n(530483),m=n(415008);function p(){var e=(0,d.default)(),t=(0,l.useAppSelector)((function(e){return e.settings.validationSetting}));return(0,o.useCallback)(function(){var n=(0,r.default)((function*(n){var r=n.encodedTx,o=n.accountId,d=n.networkId,l=n.payloadInfo,p=n.prepaidFee,h=n.onFail,g=n.onSuccess,x=n.onDetail,y=n.gasEstimateFallback,w=n.showSendFeedbackReceipt,v=(0,m.createLoggerTimer)(),k=(0,a.getWalletIdFromAccountId)(o),j=yield s.default.engine.getWallet(k),_=(yield s.default.servicePassword.getPassword())&&!(null!=t&&t.Payment);if("hw"===j.type||"external"!==j.type&&_)try{v.start(m.LoggerTimerTags.sendTransaction);var I=yield s.default.serviceSwap.sendTransaction({accountId:o,networkId:d,encodedTx:r,payload:l,autoFallback:y,prepaidFee:p}),b=I.result,S=I.decodedTx;v.end(m.LoggerTimerTags.sendTransaction),yield null==g?void 0:g({result:b,decodedTx:S}),w&&setTimeout((function(){e.navigate(u.RootRoutes.Modal,{screen:u.ModalRoutes.Send,params:{screen:f.SendModalRoutes.SendFeedbackReceipt,params:{networkId:d,accountId:o,txid:b.txid,type:"Send"}}})}),10)}catch(O){var T,M=(null==O||null==(T=O.data)?void 0:T.message)||O.message;i.default.swap.error(`swap send failed with message ${M}`),c.deviceUtils.showErrorToast(O,M),null==h||h(O)}else{setTimeout((function(){e.navigate(u.RootRoutes.Modal,{screen:u.ModalRoutes.Send,params:{screen:f.SendModalRoutes.SendConfirm,params:{accountId:o,networkId:d,payloadInfo:l,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:r,prepaidFee:p,hideSendFeedbackReceipt:!w,onDetail:x,onFail:h,onSuccess:function(e,t){var n;null==g||g({result:e,decodedTx:null!=(n=null==t?void 0:t.decodedTx)?n:void 0})}}}})}),100)}}));return function(e){return n.apply(this,arguments)}}(),[t,e])}function h(){var e=(0,d.default)(),t=(0,l.useAppSelector)((function(e){return e.settings.validationSetting}));return(0,o.useCallback)(function(){var n=(0,r.default)((function*(n){var r=n.accountId,o=n.networkId,i=n.unsignedMessage,d=n.onSuccess,l=n.onFail,p=(0,m.createLoggerTimer)(),h=(0,a.getWalletIdFromAccountId)(r),g=yield s.default.engine.getWallet(h),x=(yield s.default.servicePassword.getPassword())&&!(null!=t&&t.Payment);if("hw"===g.type||"external"!==g.type&&x)try{p.start(m.LoggerTimerTags.signMessage);var y=yield s.default.serviceTransaction.signMessage({accountId:r,networkId:o,unsignedMessage:i});p.end(m.LoggerTimerTags.signMessage),yield null==d?void 0:d(y)}catch(v){var w;c.deviceUtils.showErrorToast(v,(null==v||null==(w=v.data)?void 0:w.message)||v.message),null==l||l()}else e.navigate(u.RootRoutes.Modal,{screen:u.ModalRoutes.Send,params:{screen:f.SendModalRoutes.SignMessageConfirm,params:{accountId:r,networkId:o,unsignedMessage:i,onSuccess:d,onFail:l}}})}));return function(e){return n.apply(this,arguments)}}(),[e,t])}},401040:(e,t,n)=>{n.r(t),n.d(t,{useSwapSubmit:()=>P});var r=n(256666),o=n(196234),a=n(669083),i=n(634795),s=n(202784),d=n(206391),l=n.n(d),u=n(783112),c=n(534756),f=n(613549),m=n(447325),p=n(292147),h=n(945821),g=n(268883),x=n(859071),y=n(481047),w=n(380845),v=n(177510),k=n(436873),j=n(776553),_=n(793525),I=n(690549),b=n(556805),S=n(428357),T=n(415008),M=n(797749),O=n(552322);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(){var e=(0,i.default)((function*(e){var t,n,r,o,a=e.hash,i=e.decodedTx,s=e.params,d=e.response,u=e.recipient,c=e.quote,f=null==d?void 0:d.result;if(void 0!==d&&void 0!==f){var p,g=[(0,v.clearState)()],x=f.sellAmount||c.sellAmount,y=f.buyAmount||c.buyAmount,j=c.type,_=c.quoterlogo,I=yield h.default.engine.getNetwork(s.tokenIn.networkId),S=yield h.default.engine.getNetwork(s.tokenIn.networkId),M=(0,T.getTokenAmountValue)(s.tokenIn,x),O=(0,T.getTokenAmountValue)(s.tokenOut,y),R=null==i?void 0:i.nonce;i&&(p=(0,T.calculateDecodedTxNetworkFee)(i,I));var A={networkId:s.tokenIn.networkId,token:s.tokenIn,amount:(0,T.formatAmount)(new(l())(f.sellAmount).shiftedBy(-s.tokenIn.decimals))||(0,T.formatAmount)(M)},C={networkId:s.tokenOut.networkId,token:s.tokenOut,amount:(0,T.formatAmount)(new(l())(f.buyAmount).shiftedBy(-s.tokenOut.decimals))||(0,T.formatAmount)(O)};g.push((0,k.addTransaction)({accountId:s.activeAccount.id,networkId:s.tokenIn.networkId,transaction:{hash:a,from:s.activeAccount.address,addedTime:Date.now(),status:"pending",type:"swap",accountId:s.activeAccount.id,networkId:s.tokenIn.networkId,quoterType:j,quoterLogo:_,nonce:R,attachment:d.attachment,receivingAccountId:null==u?void 0:u.accountId,receivingAddress:null==u?void 0:u.address,providers:null!=(t=null==f?void 0:f.sources)?t:c.providers,arrivalTime:c.arrivalTime,percentageFee:c.percentageFee,protocalFees:c.protocolFees,networkFee:p,viewed:!1,tokens:{from:A,to:C,rate:Number(null!=(n=null==f?void 0:f.instantRate)?n:c.instantRate)}}}));var P,B=(0,w.appSelector)((function(e){return e.swapTransactions.slippage}));if(B&&B.autoReset&&g.push((0,k.setSlippage)({mode:"auto"})),h.default.dispatch.apply(h.default,g),h.default.serviceToken.addAccountToken(s.tokenIn.networkId,s.activeAccount.id,s.tokenIn.tokenIdOnNetwork),s.tokenIn.networkId===s.tokenOut.networkId&&h.default.serviceToken.addAccountToken(s.tokenOut.networkId,s.activeAccount.id,s.tokenOut.tokenIdOnNetwork),"swftc"===(null==(r=d.result)?void 0:r.quoter)&&null!=(o=d.attachment)&&o.swftcOrderId)b.SwapQuoter.client.swftModifyTxId(null==(P=d.attachment)?void 0:P.swftcOrderId,a);var D=null==I?void 0:I.shortName,N=null==S?void 0:S.shortName;h.default.serviceSwap.addRecord({txid:a,from:{networkId:A.networkId,networkName:null!=D?D:"",tokenAddress:A.token.tokenIdOnNetwork,tokenName:A.token.name,amount:A.amount},to:{networkId:C.networkId,networkName:null!=N?N:"",tokenAddress:C.token.tokenIdOnNetwork,tokenName:C.token.name,amount:C.amount},params:s,response:d}),m.appUIEventBus.emit(m.AppUIEventBusNames.SwapAddTransaction)}}));return function(t){return e.apply(this,arguments)}}();var P=function(){var e=(0,u.default)(),t=(0,M.useSwapSend)(),n=(0,x.useNavigation)();return(0,s.useCallback)(function(){var r=(0,i.default)((function*(r){var s,d,u=r.params,x=r.quote,v=r.recipient,k=r.onSuccess,M=r.setProgressStatus,R=r.openProgressStatus,P=r.closeProgressStatus;if(u&&x&&v){var B=u.activeAccount,D=new T.TokenAmount(u.tokenIn,(0,T.getTokenAmountValue)(u.tokenIn,x.sellAmount).toFixed()),N="0";u.tokenIn.tokenIdOnNetwork||(N=D.value.toFixed());var E=new T.TokenAmount(u.tokenOut,(0,T.getTokenAmountValue)(u.tokenOut,x.buyAmount).toFixed());if(yield h.default.serviceSwap.checkAccountInWallets(B.id)){var L=u.tokenIn.networkId,F=yield h.default.engine.getNetwork(L);if(F){var H=(0,T.createLoggerTimer)();H.start(T.LoggerTimerTags.checkTokenBalance),null==M||M({title:e.formatMessage({id:"action__confirming_balance_str"},{0:""})});var $=yield h.default.serviceToken.getAccountBalanceFromRpc(F.id,B.id,[],!0),q=(0,o.default)($,1)[0],U=null==q||null==(s=q.main)?void 0:s.balance,z=U?`${u.tokenIn.networkId} native token balance is ${U}`:`${u.tokenIn.networkId} failed to fetch native token balance`;p.default.swap.info(z),H.end(T.LoggerTimerTags.checkTokenBalance);var V=new(l())(null!=U?U:"0");if(V.isZero()){var K=yield h.default.engine.getNativeTokenInfo(L);a.default.show({title:e.formatMessage({id:"msg__str_insufficient_balance_to_pay_for_gas_fee"},{0:K.symbol.toUpperCase()})},{type:"error"})}else{var Q=0;if(V.gt(0))try{var W,G=yield h.default.servicePassword.getPassword(),X=yield h.default.engine.getFrozenBalance({accountId:B.id,networkId:F.id,password:G});p.default.swap.info("get frozenBalance ",X),Q="number"===typeof X?X:null!=(W=null==X?void 0:X[u.tokenIn.id])?W:0}catch(be){p.default.swap.info("failed to get frozen balanace",be.message)}var J=yield h.default.serviceSwap.getBasicGasFeeWithTimeout(F.id);if(J=(0,T.plus)(J,Q),(u.tokenIn.tokenIdOnNetwork?V:V.minus(D.typedValue)).lt(J)){var Z=(yield h.default.engine.getNativeTokenInfo(L)).symbol.toUpperCase(),Y=0===Q?e.formatMessage({id:"msg__suggest_reserving_str_as_gas_fee"},{0:`${J} ${Z}`}):e.formatMessage({id:"msg__insufficient_funds_for_transaction"},{0:`${Q} ${Z}`,1:`${J} ${Z}`});a.default.show({title:Y},{type:"error"})}else{var ee,te=A(A({},u),{},{activeAccount:B,receivingAddress:null==v?void 0:v.address,txData:x.txData,additionalParams:x.additionalParams,sellAmount:x.sellAmount,buyAmount:x.buyAmount,onChainSatsPerVbyte:x.onChainSatsPerVbyte,disableValidate:!0});try{H.start(T.LoggerTimerTags.buildTransaction),null==M||M({title:e.formatMessage({id:"action__building_transaction_data_str"},{0:""})}),ee=yield b.SwapQuoter.client.buildTransaction(x.type,te),H.end(T.LoggerTimerTags.buildTransaction)}catch(be){var ne,re,oe=(null==be||null==(ne=be.response)||null==(re=ne.data)?void 0:re.message)||be.message;return void a.default.show({title:oe},{type:"error"})}if(void 0!==ee&&null!=(d=ee)&&d.data){var ae=function(e){var t=e.swapQuote,n=e.quoteParams,r=e.inputAmount,o=e.outputAmount,a=e.account,i=e.receivingAddress,s=n.networkIn,d=n.networkOut,l=n.tokenIn,u=n.tokenOut,c=n.slippagePercentage,f=n.independentField;return{accountAddress:a.address,receivingAddress:i,send:{networkId:s.id,tokenInfo:l,amount:r.typedValue,amountValue:r.amount.toFixed()},receive:{networkId:d.id,tokenInfo:u,amount:o.typedValue,amountValue:o.amount.toFixed()},slippagePercentage:c,independentField:f,swapQuote:t}}({quoteParams:u,inputAmount:D,outputAmount:E,swapQuote:x,account:B,receivingAddress:null==v?void 0:v.address}),ie=ee.data;if(void 0!==ie){if(F.impl===f.IMPL_EVM){var se=ie.value;se.startsWith("0x")||(ie.value=(0,T.toHex)(se))}p.default.swap.info("swap encodedTx: ",JSON.stringify(ie));var de=ee.result;if(de){var le,ue,ce=(0,c.getWalletIdFromAccountId)(B.id),fe=yield h.default.engine.getWallet(ce),me=!1;if(de.allowanceTarget&&u.tokenIn.tokenIdOnNetwork){H.start(T.LoggerTimerTags.checkTokenAllowance);var pe=yield h.default.engine.getTokenAllowance({networkId:u.tokenIn.networkId,accountId:u.activeAccount.id,tokenIdOnNetwork:u.tokenIn.tokenIdOnNetwork,spender:de.allowanceTarget});H.end(T.LoggerTimerTags.checkTokenAllowance),pe?(p.default.swap.info(`${u.tokenIn.networkId} ${u.tokenIn.symbol} allowance is ${pe}`),me=new(l())((0,T.getTokenAmountString)(u.tokenIn,pe)).lt(de.sellAmount)):p.default.swap.info(`${u.tokenIn.networkId} ${u.tokenIn.symbol} failed to fetch token allowance`);var he=yield h.default.serviceSwap.needToResetApproval(u.tokenIn);if(me&&he&&Number(pe||"0")>0&&(ue=yield h.default.engine.buildEncodedTxFromApprove({spender:de.allowanceTarget,networkId:u.tokenIn.networkId,accountId:B.id,token:u.tokenIn.tokenIdOnNetwork,amount:"0"})),me){var ge=(0,w.appSelector)((function(e){return e.settings.disableSwapExactApproveAmount}))?"unlimited":(0,T.getTokenAmountValue)(u.tokenIn,de.sellAmount).toFixed();le=yield h.default.engine.buildEncodedTxFromApprove({spender:de.allowanceTarget,networkId:u.tokenIn.networkId,accountId:B.id,token:u.tokenIn.tokenIdOnNetwork,amount:ge}),ue&&ue.nonce&&(le.nonce=Number(ue.nonce)+1)}}var xe=[],ye=function(){var r=(0,i.default)((function*(){null==M||M({title:e.formatMessage({id:"action__swapping_str"},{0:""})});try{yield t({accountId:B.id,networkId:L,gasEstimateFallback:Boolean(le),encodedTx:ie,showSendFeedbackReceipt:!0,payloadInfo:{type:"InternalSwap",swapInfo:ae},prepaidFee:N,onDetail:function(e){n.navigate(y.RootRoutes.Modal,{screen:y.ModalRoutes.Swap,params:{screen:S.SwapRoutes.Transaction,params:{txid:e}}})},onSuccess:function(){var e=(0,i.default)((function*(e){var t=e.result,n=e.decodedTx;ee&&(yield C({hash:t.txid,decodedTx:n,params:te,response:ee,quote:x,recipient:v}),m.appUIEventBus.emit(m.AppUIEventBusNames.SwapCompleted),null==k||k({result:t,decodedTx:n}))}));return function(t){return e.apply(this,arguments)}}(),onFail:function(){m.appUIEventBus.emit(m.AppUIEventBusNames.SwapError)}})}finally{null==P||P()}}));return function(){return r.apply(this,arguments)}}();if(xe.unshift(ye),le){var we=function(){var r=(0,i.default)((function*(r){var o={type:"InternalSwap"},a=(0,w.appSelector)((function(e){var t;return null==(t=e.settings.validationSetting)?void 0:t[g.ValidationFields.Payment]}));"external"===fe.type||a||(o.swapInfo=A(A({},ae),{},{isApprove:!0})),H.start(T.LoggerTimerTags.approval),null==M||M({title:e.formatMessage({id:"action__authorizing_str"},{0:""})}),yield t({accountId:B.id,networkId:L,payloadInfo:o,encodedTx:le,gasEstimateFallback:Boolean(ue),onSuccess:function(){var e=(0,i.default)((function*(){"hw"===fe.type&&n.navigate(y.RootRoutes.Modal,{screen:y.ModalRoutes.Send,params:{screen:y.SendModalRoutes.HardwareSwapContinue,params:{networkId:L,accountId:B.id}}}),yield null==r?void 0:r()}));return function(){return e.apply(this,arguments)}}(),onFail:function(){null==P||P()}}),H.end(T.LoggerTimerTags.approval)}));return function(e){return r.apply(this,arguments)}}();xe.unshift(we)}if(ue){var ve=function(){var e=(0,i.default)((function*(e){var n={type:"InternalSwap"},r=(0,w.appSelector)((function(e){var t;return null==(t=e.settings.validationSetting)?void 0:t[g.ValidationFields.Payment]}));"external"===fe.type||r||(n.swapInfo=A(A({},ae),{},{isApprove:!0})),H.start(T.LoggerTimerTags.cancelApproval),yield t({accountId:B.id,networkId:L,payloadInfo:n,encodedTx:ue,onSuccess:function(){var t=(0,i.default)((function*(){yield null==e?void 0:e()}));return function(){return t.apply(this,arguments)}}()}),H.end(T.LoggerTimerTags.cancelApproval)}));return function(t){return e.apply(this,arguments)}}();xe.unshift(ve)}ue?(0,_.showOverlay)((function(e){return(0,O.jsx)(I.SwapTransactionsCancelApprovalBottomSheetModal,{close:e,onSubmit:(0,i.default)((function*(){try{null==R||R(),yield(0,T.combinedTasks)(xe)}finally{null==P||P()}}))})})):yield(0,T.combinedTasks)(xe),yield(0,j.wait)(1e3)}else a.default.show({title:e.formatMessage({id:"msg__unknown_error"})},{type:"error"})}else a.default.show({title:e.formatMessage({id:"msg__unknown_error"})},{type:"error"})}else{var ke,je,_e,Ie=null!=(ke=null==(je=ee)||null==(_e=je.error)?void 0:_e.msg)?ke:e.formatMessage({id:"msg__unknown_error"});a.default.show({title:Ie},{type:"error"})}}}}else a.default.show({title:e.formatMessage({id:"msg__unknown_error"})},{type:"error"})}else a.default.show({title:e.formatMessage({id:"msg__account_deleted"},{0:B.name})},{type:"error"})}else a.default.show({title:e.formatMessage({id:"msg__unknown_error"})},{type:"error"})}));return function(e){return r.apply(this,arguments)}}(),[])}},556805:(e,t,n)=>{n.r(t),n.d(t,{SwapQuoter:()=>O});var r=n(256666),o=n(634795),a=n(887371),i=n(789644),s=n.n(i),d=n(206391),l=n.n(d),u=n(849877),c=n(398514),f=n(942013),m=n(613549),p=n(292147),h=n(945821),g=n(428357),x=n(415008),y=function(){function e(){this.type=g.QuoterType.zeroX}return e.prototype.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield h.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})};var o=yield h.default.serviceNetwork.rpcCall(t,{method:"eth_getTransactionReceipt",params:[e.hash]});return o?{status:1===Number(o.status)?"sucesss":"failed"}:Date.now()-e.addedTime>864e5?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(e)}();function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(){var e=t.prototype;function t(){this.type=g.QuoterType.deezy,this.client=s().create({timeout:6e4})}return e.getBaseUrl=function(){var e=(0,o.default)((function*(){return`${yield h.default.serviceSwap.getServerEndPoint()}/deezy`}));return function(){return e.apply(this,arguments)}}(),e.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){var t,n;console.log("=====>>>>TX: ",e);var r,o,a,i,d=(0,m.isLightningNetworkByNetworkId)(e.networkId),l=yield this.getBaseUrl(),u=((n={networkId:e.networkId})[d?"bolt11Invoice":"secretAccessKey"]=null==(t=e.attachment)?void 0:t.swftcOrderId,n),c=yield s().get(`${l}${d?"/lookupLnToBtc":"/lookupBtcToLn"}`,{params:u});return c.data&&c.data.progress?v(v({},c.data.progress),{},{status:"success"===(null==(r=c.data)||null==(o=r.progress)?void 0:o.status)?"sucesss":null==(a=c.data)||null==(i=a.progress)?void 0:i.status}):{status:"pending",destinationTransactionHash:d?c.data.on_chain_txid:""}}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(t)}(),j=function(){function e(){this.type=g.QuoterType.jupiter}return e.prototype.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.hash;return{status:yield h.default.serviceHistory.queryTransactionByTxid({networkId:t,accountId:n,txid:r})}}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(e)}(),_=function(){function e(){this.type=g.QuoterType.socket,this.client=s().create({timeout:3e4})}var t=e.prototype;return t.getBaseURL=function(){var e=(0,o.default)((function*(){return`${yield h.default.serviceSwap.getServerEndPoint()}/socketBridge`}));return function(){return e.apply(this,arguments)}}(),t.querySocketBridgeStatus=function(){var e=(0,o.default)((function*(e){var t,n;try{var r=yield this.getBaseURL();n=yield this.client.get(`${r}/bridge-status`,{params:e})}catch(i){return void console.log(i)}var o,a=n.data.result;return"COMPLETED"===a.sourceTxStatus&&"COMPLETED"===a.destinationTxStatus||"COMPLETED"===(null==(t=a.refuel)?void 0:t.status)?{status:"sucesss",destinationTransactionHash:a.destinationTransactionHash||(null==(o=a.refuel)?void 0:o.destinationTransactionHash)}:"FAILED"===a.destinationTxStatus||"FAILED"===a.sourceTxStatus?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),t.queryCrosschainTransactionProgress=function(){var e=(0,o.default)((function*(e){var t=e.nonce,n=e.networkId,r=e.accountId,o=e.tokens,a=e.attachment;if(void 0!==t&&o)for(var i=o.from,s=o.to,d=(0,x.getChainIdFromNetworkId)(i.networkId),l=(0,x.getChainIdFromNetworkId)(s.networkId),u=yield h.default.serviceHistory.getTransactionsWithNonce({nonce:t,networkId:n,accountId:r}),c=0;c<u.length;c+=1){var f,m=u[c].decodedTx.txid,p=yield this.querySocketBridgeStatus({fromChainId:d,toChainId:l,transactionHash:m,bridgeName:null==a||null==(f=a.socketUsedBridgeNames)?void 0:f[0]});if("sucesss"===(null==p?void 0:p.status))return{status:p.status,destinationTransactionHash:p.destinationTransactionHash};if("failed"===(null==p?void 0:p.status))return{status:p.status};if(null!=p&&p.destinationTransactionHash)return{destinationTransactionHash:p.destinationTransactionHash}}if(Date.now()-e.addedTime>864e5)return{status:"failed"}}));return function(t){return e.apply(this,arguments)}}(),t.querySimpleTransactionProgress=function(){var e=(0,o.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield h.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})};var o=yield h.default.serviceNetwork.rpcCall(t,{method:"eth_getTransactionReceipt",params:[e.hash]});return o?{status:1===Number(o.status)?"sucesss":"failed"}:Date.now()-e.addedTime>864e5?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){if(e.tokens){var t=yield this.querySimpleTransactionProgress(e);return"failed"===(null==t?void 0:t.status)||"canceled"===(null==t?void 0:t.status)?t:this.queryCrosschainTransactionProgress(e)}}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(e)}(),I=function(){var e=t.prototype;function t(){this.type=g.QuoterType.swftc,this.client=s().create({timeout:6e4})}return e.getBaseUrl=function(){var e=(0,o.default)((function*(){return`${yield h.default.serviceSwap.getServerEndPoint()}/swft`}));return function(){return e.apply(this,arguments)}}(),e.modifyTxId=function(){var e=(0,o.default)((function*(e,t){var n=`${yield this.getBaseUrl()}/modifyTxId`;return(yield this.client.post(n,{orderId:e,depositTxid:t})).data.data}));return function(t,n){return e.apply(this,arguments)}}(),e.getTxOrderInfo=function(){var e=(0,o.default)((function*(e){var t,n,r=null!=(t=null==(n=e.attachment)?void 0:n.swftcOrderId)?t:e.thirdPartyOrderId;if(r){var o=`${yield this.getBaseUrl()}/queryOrderState`;return(yield s().post(o,{equipmentNo:e.from,sourceType:"H5",orderId:r})).data.data}}));return function(t){return e.apply(this,arguments)}}(),e.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){var t,n,r=null!=(t=null==(n=e.attachment)?void 0:n.swftcOrderId)?t:e.thirdPartyOrderId;if(r){var o=`${yield this.getBaseUrl()}/queryOrderState`,a=(yield s().post(o,{equipmentNo:e.from,sourceType:"H5",orderId:r})).data.data;if("complete"===a.tradeState)return{status:"sucesss",destinationTransactionHash:a.transactionId};if("refund_complete"===a.tradeState)return{status:"failed"};if(a.transactionId)return{destinationTransactionHash:a.transactionId}}var i=e.networkId,d=e.accountId,l=e.nonce,c=e.hash;if("evm"===(0,u.getNetworkImpl)(i)&&void 0!==l){var f=yield h.default.serviceHistory.queryTransactionNonceStatus({networkId:i,accountId:d,nonce:l});if("canceled"===f||"failed"===f)return{status:f}}else if("evm"!==(0,u.getNetworkImpl)(i)){var m=yield h.default.serviceHistory.queryTransactionByTxid({networkId:i,accountId:d,txid:c});if("canceled"===m||"failed"===m)return{status:m}}if(Date.now()-e.addedTime>864e5)return{status:"failed"}}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(t)}(),b=function(){function e(){this.type=g.QuoterType.thorswap}var t=e.prototype;return t.getBaseUrl=function(){var e=(0,o.default)((function*(){return`${yield h.default.serviceSwap.getServerEndPoint()}/thorswap`}));return function(){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce,o=e.hash,a=e.attachment;if(void 0!==r){var i=yield h.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r});if("failed"===i||"canceled"===i)return{status:i}}if(o&&null!=a&&a.thorswapQuoteId){var s=yield this.getTransactionInfo(e);if(s&&"success"===s.status)return{status:"sucesss",destinationTransactionHash:s.destinationTransactionHash}}if(Date.now()-e.addedTime>864e5)return{status:"failed"}}));return function(t){return e.apply(this,arguments)}}(),t.getTransactionInfo=function(){var e=(0,o.default)((function*(e){var t=e.hash,n=e.attachment;if(t&&null!=n&&n.thorswapQuoteId){var r=`${yield this.getBaseUrl()}/transaction_status_v2`;try{return(yield s().get(r,{params:{hash:t,quoteId:null==n?void 0:n.thorswapQuoteId}})).data}catch(o){return void p.default.common.info("thorswap getTransactionInfo error",o)}}}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(e)}(),S=function(){function e(){this.type=g.QuoterType.thorswapStream,this.client=new b}return e.prototype.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){return this.client.queryTransactionProgress(e)}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(e)}();function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(){function e(){this.httpClient=s().create({timeout:6e4}),this.jupiter=new j,this.swftc=new I,this.simple=new y,this.socket=new _,this.thorswap=new b,this.thorswapStream=new S,this.deezy=new k,this.quoters=[this.simple,this.socket,this.jupiter,this.swftc,this.deezy,this.thorswap,this.thorswapStream],this.transactionReceipts={},this.solTransactionReceipts={}}var t=e.prototype;return t.convertOrderToTransaction=function(){var e=(0,o.default)((function*(e,t){var n=e.tokenIn,r=e.networkIn,o=e.activeAccount,a=e.sellAmount;if(a&&n){if(!t.platformAddr)throw new Error("failed to build transaction due to invalid platformAddr");var i=new(l())(a).shiftedBy(-n.decimals).toFixed();return n.tokenIdOnNetwork?yield h.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.platformAddr,amount:i,token:n.tokenIdOnNetwork}}):yield h.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.platformAddr,amount:i}})}}));return function(t,n){return e.apply(this,arguments)}}(),t.convertThorswapOrderToTransaction=function(){var e=(0,o.default)((function*(e,t){var n=e.tokenIn,r=e.networkIn,o=e.activeAccount,a=e.sellAmount;if(a&&n){if(!t.tcVault)throw new Error("failed to build transaction due to invalid tcVault");var i,s=new(l())(a).shiftedBy(-n.decimals).toFixed();if(!n.tokenIdOnNetwork&&[f.OnekeyNetwork.btc,f.OnekeyNetwork.doge,f.OnekeyNetwork.ltc,f.OnekeyNetwork.bch].includes(r.id)){if(i=yield h.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.tcVault,amount:s,opReturn:t.memo}}))if(!i.outputs.some((function(e){var n;return(null==(n=e.payload)?void 0:n.opReturn)===t.memo})))throw new Error("failed to build transaction due to invalid opReturn");return i}if(!n.tokenIdOnNetwork&&[f.OnekeyNetwork.cosmoshub].includes(r.id))return i=yield h.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.tcVault,amount:s,destinationTag:t.memo}});throw new Error("not support network")}}));return function(t,n){return e.apply(this,arguments)}}(),t.fetchLimitOrderQuote=function(){var e=(0,o.default)((function*(e){var t,n,r=(0,x.convertLimitOrderParams)(e);if(r){r.quoterType="0x";var o=`${yield h.default.serviceSwap.getServerEndPoint()}/exchange/quote`,a=null==(t=(yield this.httpClient.get(o,{params:r})).data)?void 0:t.data;if(a&&null!=(n=a.result)&&n.instantRate)return{instantRate:(0,x.formatAmountExact)(a.result.instantRate)}}}));return function(t){return e.apply(this,arguments)}}(),t.buildQuote=function(){var e=(0,o.default)((function*(e){var t=e.responses,n=e.params;if(t&&0!==t.length){var r,o=t.filter((function(e){var t;return null==(t=e.result)?void 0:t.allowanceTarget})).map((function(e){return e.result.allowanceTarget})),a=yield h.default.engine.batchTokensAllowance({networkId:n.tokenIn.networkId,accountId:n.activeAccount.id,tokenIdOnNetwork:n.tokenIn.tokenIdOnNetwork,spenders:o});return a&&a.length===o.length&&o.forEach((function(e,t){var n=a[t];r||(r={}),r[e]=n})),t.map((function(e){var t,n=e.result,o=0;"swft"===n.quoter&&(o=.002);var a,i=o+Number(null!=(t=n.percentageFee)?t:0),s={type:n.quoter,quoterlogo:n.quoterLogo,instantRate:n.instantRate,sellAmount:n.sellAmount,sellTokenAddress:n.sellTokenAddress,buyAmount:n.buyAmount,buyTokenAddress:n.buyTokenAddress,providers:n.sources,percentageFee:n.percentageFee,allowanceTarget:n.allowanceTarget,arrivalTime:n.arrivalTime,needApproved:!1,estimatedBuyAmount:(0,x.multiply)(n.buyAmount,1-i),minAmountOut:n.minAmountOut,protocolFees:n.protocolFees,estimatedPriceImpact:n.estimatedPriceImpact,onChainSatsPerVbyte:n.onChainSatsPerVbyte,notImpactBySlippage:n.notImpactBySlippage,quoteExtraData:n.quoterExtraData};if(s.allowanceTarget&&r){var d=r[s.allowanceTarget];void 0!==d&&n.sellAmount&&(s.needApproved=Number(n.sellAmount)>d)}return e.limit&&(a={max:e.limit.max,min:e.limit.min}),{data:s,limited:a}}))}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuote=function(){var e=(0,o.default)((function*(e){var t,n=(0,x.convertParams)(e);if(n){var r=yield h.default.serviceSwap.getCurrentUserSelectedQuoter();r&&(n.quoterType=r);var o=`${yield h.default.serviceSwap.getServerEndPoint()}/exchange/quote`,a=null==(t=(yield this.httpClient.get(o,{params:n})).data)?void 0:t.data;if(a){var i=yield this.buildQuote({responses:[a],params:e});return null==i?void 0:i[0]}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuotes=function(){var e=(0,o.default)((function*(e){var t,n=(0,x.convertParams)(e);if(n){var r=`${yield h.default.serviceSwap.getServerEndPoint()}/exchange/quote_all`,o=null==(t=(yield this.httpClient.get(r,{params:n})).data)?void 0:t.data;if(o){var a=yield this.buildQuote({responses:o,params:e});if(a)return a.filter((function(e){return Boolean(e)}))}}}));return function(t){return e.apply(this,arguments)}}(),t.parseRequestId=function(e){try{var t=e.config.headers,n=null==t?void 0:t["x-onekey-request-id"];if(!n){var r=null==t?void 0:t["X-Request-By"];if("string"===typeof r)n=JSON.parse(r)["x-onekey-request-id"]}return n}catch(o){p.default.common.error("Failed to get request id with reason",o.message)}},t.buildTransaction=function(){var e=(0,o.default)((function*(e,t){var n,r=(0,x.convertBuildParams)(t);if(r){r.quoterType=e,r.disableValidate=Boolean(t.disableValidate);var o=`${yield h.default.serviceSwap.getServerEndPoint()}/exchange/build_tx`,a=yield this.httpClient.post(o,r),i=this.parseRequestId(a),s=a.data;if(s.errMsg)throw new Error(s.errMsg);if(null!=s&&s.transaction){if("object"===typeof s.transaction){if(t.networkIn.impl===m.IMPL_APTOS)return{data:M(M({},s.transaction),{},{sender:t.activeAccount.address}),result:s.result,requestId:i};var d={data:M(M({},s.transaction),{},{from:t.activeAccount.address}),result:s.result,requestId:i};return s.thor&&(d.attachment={thorswapQuoteId:s.thor.quoteId}),d}var l={data:s.transaction,result:s.result,requestId:i};return s.thor&&(l.attachment={thorswapQuoteId:s.thor.quoteId}),l}if(s.order&&null!=(n=s.result)&&n.instantRate)return{data:yield this.convertOrderToTransaction(t,s.order),result:s.result,attachment:{swftcOrderId:s.order.orderId,swftcPlatformAddr:s.order.platformAddr,swftcDepositCoinAmt:s.order.depositCoinAmt,swftcDepositCoinCode:s.order.depositCoinCode,swftcReceiveCoinAmt:s.order.receiveCoinAmt,swftcReceiveCoinCode:s.order.receiveCoinCode},requestId:i};if(s.thorOrder){var u={data:yield this.convertThorswapOrderToTransaction(t,s.thorOrder),result:s.result};return s.thor&&(u.attachment={thorswapQuoteId:s.thor.quoteId}),u}}}));return function(t,n){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=(0,o.default)((function*(e){if((0,x.isSimpleTx)(e))return this.simple.queryTransactionProgress(e);for(var t=(0,x.getQuoteType)(e),n=0;n<this.quoters.length;n+=1){var r=this.quoters[n];if(r.type===t)return r.queryTransactionProgress(e)}}));return function(t){return e.apply(this,arguments)}}(),t.getHistoryTx=function(){var e=(0,o.default)((function*(e){var t=h.default.serviceHistory,n=e.accountId,r=e.networkId,o=e.nonce;if((0,u.getNetworkImpl)(e.networkId)!==m.IMPL_EVM||void 0===o)return(yield t.getLocalHistory({accountId:n,networkId:r})).find((function(t){return t.decodedTx.txid===e.hash}));var a=(yield t.getTransactionsWithNonce({accountId:n,networkId:r,nonce:o})).find((function(e){return e.decodedTx.status===c.IDecodedTxStatus.Confirmed}));return a||void 0}));return function(t){return e.apply(this,arguments)}}(),t.getTransactionReceipt=function(){var e=(0,o.default)((function*(e,t){var n,r;if(this.transactionReceipts[e]||(this.transactionReceipts[e]={}),null!=(n=this.transactionReceipts[e])&&n[t])return null==(r=this.transactionReceipts[e])?void 0:r[t];var o=yield h.default.serviceNetwork.rpcCall(e,{method:"eth_getTransactionReceipt",params:[t]});return o?(this.transactionReceipts[e][t]=o,o):void 0}));return function(t,n){return e.apply(this,arguments)}}(),t.getSOLTransactionReceipt=function(){var e=(0,o.default)((function*(e,t){var n,r;if(this.solTransactionReceipts[e]||(this.solTransactionReceipts[e]={}),null!=(n=this.solTransactionReceipts[e])&&n[t])return null==(r=this.solTransactionReceipts[e])?void 0:r[t];var o=yield h.default.serviceNetwork.rpcCall(e,{method:"getTransaction",params:[t,{encoding:"jsonParsed",maxSupportedTransactionVersion:0}]});return o?(this.solTransactionReceipts[e][t]=o,o):void 0}));return function(t,n){return e.apply(this,arguments)}}(),t.doQueryReceivedToken=function(){var e=(0,o.default)((function*(e,t,n){if((0,x.isEvmNetworkId)(t.networkId)){var r=yield this.getTransactionReceipt(t.networkId,e);if(r){var o,a=function(e){return`0x${e.slice(2).replace(/^0+/,"").padStart(40,"0")}`};if(t.tokenIdOnNetwork){var i,s=null==(i=r.logs)?void 0:i.find((function(e){return a(e.address.toLowerCase())===t.tokenIdOnNetwork.toLowerCase()&&3===e.topics.length&&e.topics[2]&&a(e.topics[2])===n.toLowerCase()}));return null==s?void 0:s.data}var d=null==(o=r.logs)?void 0:o.find((function(e){if(2===e.topics.length){var t=e.topics[0];if("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"===a(t).toLowerCase())return!0}return!1}));return null==d?void 0:d.data}}else if((0,x.isSolNetworkId)(t.networkId)){var l=yield this.getSOLTransactionReceipt(t.networkId,e);if(l){var u=function(e){var r=t.tokenIdOnNetwork;return e.owner.toLowerCase()===n.toLowerCase()&&e.mint.toLowerCase()===r.toLowerCase()},c=l.meta.preTokenBalances.find(u),f=l.meta.postTokenBalances.find(u);if(c&&f)return(0,x.minus)(f.uiTokenAmount.amount,c.uiTokenAmount.amount)}}}));return function(t,n,r){return e.apply(this,arguments)}}(),t.getActualReceived=function(){var e=(0,o.default)((function*(e){if(e.tokens){var t=e.receivingAddress,n=e.tokens,r=n.from,o=n.to;if("swftc"===(null==e?void 0:e.quoterType)){var a=yield this.swftc.getTxOrderInfo(e);if(a)return a.receiveCoinAmt}else if((null==e?void 0:e.quoterType)===g.QuoterType.thorswap||e.quoterType===g.QuoterType.thorswapStream){var i=yield this.thorswap.getTransactionInfo(e);if(i)return i.actualReceived}else{var s=yield this.getHistoryTx(e),d=(null==s?void 0:s.decodedTx.txid)||e.hash;if((0,x.isEvmNetworkId)(r.networkId)&&(0,x.isEvmNetworkId)(o.networkId)&&t){if(d&&r.networkId===o.networkId){var l=yield this.doQueryReceivedToken(d,o.token,t);if(l)return(0,x.getTokenAmountValue)(e.tokens.to.token,l).toFixed()}else if(e.destinationTransactionHash){var u=yield this.doQueryReceivedToken(e.destinationTransactionHash,o.token,t);if(u)return(0,x.getTokenAmountValue)(e.tokens.to.token,u).toFixed()}}else if((0,x.isSolNetworkId)(r.networkId)&&(0,x.isSolNetworkId)(o.networkId)&&t){var c=yield this.doQueryReceivedToken(e.hash,o.token,t);if(c)return(0,x.getTokenAmountValue)(e.tokens.to.token,c).toFixed()}}}}));return function(t){return e.apply(this,arguments)}}(),t.getTxCompletedTime=function(){var e=(0,o.default)((function*(e){if(e.tokens){var t=e.tokens.to;if((0,x.isEvmNetworkId)(t.networkId)){var n=e.hash,r=yield this.getHistoryTx(e);null!=r&&r.decodedTx.txid&&(n=null==r?void 0:r.decodedTx.txid),e.destinationTransactionHash&&(n=e.destinationTransactionHash);var o=yield this.getTransactionReceipt(t.networkId,n);if(null!=o&&o.blockHash){var a=yield h.default.serviceNetwork.rpcCall(t.networkId,{method:"eth_getBlockByHash",params:[o.blockHash,!0]});if(null!=a&&a.timestamp)return new(l())(a.timestamp).multipliedBy(1e3).toFixed()}}}}));return function(t){return e.apply(this,arguments)}}(),t.getTxActualNetworkFee=function(){var e=(0,o.default)((function*(e){if(e.tokens){var t=e.tokens.from;if((0,x.isEvmNetworkId)(t.networkId)){var n=yield this.getHistoryTx(e),r=(null==n?void 0:n.decodedTx.txid)||e.hash,o=yield this.getTransactionReceipt(t.networkId,r);if(o&&o.gasUsed&&o.effectiveGasPrice){var a=yield h.default.engine.getNetwork(e.networkId);return(0,x.calculateNetworkFee)({limit:o.gasUsed,price:(0,x.div)(o.effectiveGasPrice,10**9)},a)}}}}));return function(t){return e.apply(this,arguments)}}(),t.swftModifyTxId=function(){var e=(0,o.default)((function*(e,t){return this.swftc.modifyTxId(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),(0,a.default)(e)}();O.client=new O},55337:(e,t,n)=>{e.exports=n.p+"static/media/logo.b0cff82fee531cbed919.png"},82631:(e,t,n)=>{e.exports=n.p+"static/media/logo_black.0d059a6e35833a279d7f.png"},296914:(e,t,n)=>{e.exports=n.p+"static/media/eth_logo.ff687f0814e58f417f8a.png"},345075:(e,t,n)=>{e.exports=n.p+"static/media/lido_pool.3f0c026b6b7b13591af6.png"},31031:(e,t,n)=>{e.exports=n.p+"static/media/matic_logo.063c9a8aaf4929a70137.png"}}]);